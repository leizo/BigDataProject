[2022-06-15 21:09:53,275] {processor.py:163} INFO - Started process (PID=4602) to work on /home/leizo/airflow/dags/my_first_dag.py
[2022-06-15 21:09:53,277] {processor.py:642} INFO - Processing file /home/leizo/airflow/dags/my_first_dag.py for tasks to queue
[2022-06-15 21:09:53,277] {logging_mixin.py:109} INFO - [2022-06-15 21:09:53,277] {dagbag.py:500} INFO - Filling up the DagBag from /home/leizo/airflow/dags/my_first_dag.py
[2022-06-15 21:10:23,280] {logging_mixin.py:109} INFO - [2022-06-15 21:10:23,279] {timeout.py:36} ERROR - Process timed out, PID: 4602
[2022-06-15 21:10:23,281] {logging_mixin.py:109} INFO - [2022-06-15 21:10:23,281] {dagbag.py:334} ERROR - Failed to import: /home/leizo/airflow/dags/my_first_dag.py
Traceback (most recent call last):
  File "/home/leizo/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 848, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/home/leizo/airflow/dags/my_first_dag.py", line 8, in <module>
    from lib.raw_to_fmt_spotify import raw_to_fmt_spotify
  File "/home/leizo/airflow/dags/lib/raw_to_fmt_spotify.py", line 8, in <module>
    spark = SparkSession \
  File "/home/leizo/.local/lib/python3.8/site-packages/pyspark/sql/session.py", line 228, in getOrCreate
    sc = SparkContext.getOrCreate(sparkConf)
  File "/home/leizo/.local/lib/python3.8/site-packages/pyspark/context.py", line 392, in getOrCreate
    SparkContext(conf=conf or SparkConf())
  File "/home/leizo/.local/lib/python3.8/site-packages/pyspark/context.py", line 144, in __init__
    SparkContext._ensure_initialized(self, gateway=gateway, conf=conf)
  File "/home/leizo/.local/lib/python3.8/site-packages/pyspark/context.py", line 339, in _ensure_initialized
    SparkContext._gateway = gateway or launch_gateway(conf)
  File "/home/leizo/.local/lib/python3.8/site-packages/pyspark/java_gateway.py", line 105, in launch_gateway
    time.sleep(0.1)
  File "/home/leizo/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 37, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /home/leizo/airflow/dags/my_first_dag.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.2.5/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.2.5/best-practices.html#reducing-dag-complexity, PID: 4602
[2022-06-15 21:10:23,282] {processor.py:654} WARNING - No viable dags retrieved from /home/leizo/airflow/dags/my_first_dag.py
[2022-06-15 21:10:23,311] {processor.py:171} INFO - Processing /home/leizo/airflow/dags/my_first_dag.py took 30.040 seconds
[2022-06-15 21:13:40,257] {processor.py:163} INFO - Started process (PID=5451) to work on /home/leizo/airflow/dags/my_first_dag.py
[2022-06-15 21:13:40,259] {processor.py:642} INFO - Processing file /home/leizo/airflow/dags/my_first_dag.py for tasks to queue
[2022-06-15 21:13:40,260] {logging_mixin.py:109} INFO - [2022-06-15 21:13:40,260] {dagbag.py:500} INFO - Filling up the DagBag from /home/leizo/airflow/dags/my_first_dag.py
[2022-06-15 21:13:51,331] {logging_mixin.py:109} INFO - doesn't exist topArtist rock 20220615
[2022-06-15 21:13:51,332] {logging_mixin.py:109} INFO - doesn't exist topArtist indie 20220615
[2022-06-15 21:13:51,332] {logging_mixin.py:109} INFO - doesn't exist topArtist indie rock 20220615
[2022-06-15 21:13:51,332] {logging_mixin.py:109} INFO - doesn't exist topArtist alternative 20220615
[2022-06-15 21:13:51,332] {logging_mixin.py:109} INFO - doesn't exist topArtist pop 20220615
[2022-06-15 21:13:51,333] {logging_mixin.py:109} INFO - doesn't exist topTracks rock 20220615
[2022-06-15 21:13:51,333] {logging_mixin.py:109} INFO - doesn't exist topTracks indie 20220615
[2022-06-15 21:13:51,333] {logging_mixin.py:109} INFO - doesn't exist topTracks indie rock 20220615
[2022-06-15 21:13:51,333] {logging_mixin.py:109} INFO - doesn't exist topTracks alternative 20220615
[2022-06-15 21:13:51,333] {logging_mixin.py:109} INFO - doesn't exist topTracks pop 20220615
[2022-06-15 21:14:02,709] {logging_mixin.py:109} INFO - paquet already exists topArtist rock 20220613
[2022-06-15 21:14:03,711] {logging_mixin.py:109} INFO - paquet already exists topArtist indie 20220613
[2022-06-15 21:14:04,559] {logging_mixin.py:109} INFO - paquet already exists topArtist indie rock 20220613
[2022-06-15 21:14:05,300] {logging_mixin.py:109} INFO - paquet already exists topArtist alternative 20220613
[2022-06-15 21:14:05,824] {logging_mixin.py:109} INFO - paquet already exists topArtist pop 20220613
[2022-06-15 21:14:06,265] {logging_mixin.py:109} INFO - paquet already exists topTracks rock 20220613
[2022-06-15 21:14:06,833] {logging_mixin.py:109} INFO - paquet already exists topTracks indie 20220613
[2022-06-15 21:14:07,326] {logging_mixin.py:109} INFO - paquet already exists topTracks indie rock 20220613
[2022-06-15 21:14:07,780] {logging_mixin.py:109} INFO - paquet already exists topTracks alternative 20220613
[2022-06-15 21:14:08,249] {logging_mixin.py:109} INFO - paquet already exists topTracks pop 20220613
[2022-06-15 21:14:08,316] {logging_mixin.py:109} INFO - [2022-06-15 21:14:08,290] {dagbag.py:334} ERROR - Failed to import: /home/leizo/airflow/dags/my_first_dag.py
Traceback (most recent call last):
  File "/home/leizo/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 848, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/home/leizo/airflow/dags/my_first_dag.py", line 11, in <module>
    from lib.produce_usage import produce_usage
  File "/home/leizo/airflow/dags/lib/produce_usage.py", line 27, in <module>
    df = spark.read.parquet(HOME + "/datalake/formatted/lastfm/" + "topTracks" + "/" + e + "/" + current_day + "/lastfm.parquet")
  File "/home/leizo/.local/lib/python3.8/site-packages/pyspark/sql/readwriter.py", line 301, in parquet
    return self._df(self._jreader.parquet(_to_seq(self._spark._sc, paths)))
  File "/home/leizo/.local/lib/python3.8/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/home/leizo/.local/lib/python3.8/site-packages/pyspark/sql/utils.py", line 117, in deco
    raise converted from None
pyspark.sql.utils.AnalysisException: Path does not exist: file:/home/leizo/datalake/formatted/lastfm/topTracks/rock/20220615/lastfm.parquet
[2022-06-15 21:14:08,329] {processor.py:654} WARNING - No viable dags retrieved from /home/leizo/airflow/dags/my_first_dag.py
[2022-06-15 21:14:08,357] {processor.py:171} INFO - Processing /home/leizo/airflow/dags/my_first_dag.py took 28.104 seconds
[2022-06-16 00:44:48,351] {processor.py:163} INFO - Started process (PID=11968) to work on /home/leizo/airflow/dags/my_first_dag.py
[2022-06-16 00:44:48,355] {processor.py:642} INFO - Processing file /home/leizo/airflow/dags/my_first_dag.py for tasks to queue
[2022-06-16 00:44:48,357] {logging_mixin.py:109} INFO - [2022-06-16 00:44:48,356] {dagbag.py:500} INFO - Filling up the DagBag from /home/leizo/airflow/dags/my_first_dag.py
[2022-06-16 00:45:03,875] {logging_mixin.py:109} INFO - paquet already exists topArtist rock 20220616
[2022-06-16 00:45:04,408] {logging_mixin.py:109} INFO - paquet already exists topArtist indie 20220616
[2022-06-16 00:45:04,796] {logging_mixin.py:109} INFO - paquet already exists topArtist indie rock 20220616
[2022-06-16 00:45:05,155] {logging_mixin.py:109} INFO - paquet already exists topArtist alternative 20220616
[2022-06-16 00:45:05,662] {logging_mixin.py:109} INFO - paquet already exists topArtist pop 20220616
[2022-06-16 00:45:06,060] {logging_mixin.py:109} INFO - paquet already exists topTracks rock 20220616
[2022-06-16 00:45:06,429] {logging_mixin.py:109} INFO - paquet already exists topTracks indie 20220616
[2022-06-16 00:45:06,806] {logging_mixin.py:109} INFO - paquet already exists topTracks indie rock 20220616
[2022-06-16 00:45:07,145] {logging_mixin.py:109} INFO - paquet already exists topTracks alternative 20220616
[2022-06-16 00:45:07,518] {logging_mixin.py:109} INFO - paquet already exists topTracks pop 20220616
[2022-06-16 00:45:07,534] {processor.py:652} INFO - DAG(s) dict_keys(['my_first_dag']) retrieved from /home/leizo/airflow/dags/my_first_dag.py
[2022-06-16 00:45:07,558] {logging_mixin.py:109} INFO - [2022-06-16 00:45:07,558] {dag.py:2398} INFO - Sync 1 DAGs
[2022-06-16 00:45:07,579] {logging_mixin.py:109} INFO - [2022-06-16 00:45:07,579] {dag.py:2937} INFO - Setting next_dagrun for my_first_dag to None
[2022-06-16 00:45:07,601] {processor.py:171} INFO - Processing /home/leizo/airflow/dags/my_first_dag.py took 19.257 seconds
[2022-06-16 00:48:14,288] {processor.py:163} INFO - Started process (PID=14487) to work on /home/leizo/airflow/dags/my_first_dag.py
[2022-06-16 00:48:14,291] {processor.py:642} INFO - Processing file /home/leizo/airflow/dags/my_first_dag.py for tasks to queue
[2022-06-16 00:48:14,292] {logging_mixin.py:109} INFO - [2022-06-16 00:48:14,292] {dagbag.py:500} INFO - Filling up the DagBag from /home/leizo/airflow/dags/my_first_dag.py
[2022-06-16 00:48:28,202] {logging_mixin.py:109} INFO - paquet already exists topArtist rock 20220616
[2022-06-16 00:48:28,604] {logging_mixin.py:109} INFO - paquet already exists topArtist indie 20220616
[2022-06-16 00:48:29,069] {logging_mixin.py:109} INFO - paquet already exists topArtist indie rock 20220616
[2022-06-16 00:48:29,426] {logging_mixin.py:109} INFO - paquet already exists topArtist alternative 20220616
[2022-06-16 00:48:29,806] {logging_mixin.py:109} INFO - paquet already exists topArtist pop 20220616
[2022-06-16 00:48:30,186] {logging_mixin.py:109} INFO - paquet already exists topTracks rock 20220616
[2022-06-16 00:48:30,537] {logging_mixin.py:109} INFO - paquet already exists topTracks indie 20220616
[2022-06-16 00:48:30,868] {logging_mixin.py:109} INFO - paquet already exists topTracks indie rock 20220616
[2022-06-16 00:48:31,196] {logging_mixin.py:109} INFO - paquet already exists topTracks alternative 20220616
[2022-06-16 00:48:31,561] {logging_mixin.py:109} INFO - paquet already exists topTracks pop 20220616
[2022-06-16 00:48:31,564] {processor.py:652} INFO - DAG(s) dict_keys(['my_first_dag']) retrieved from /home/leizo/airflow/dags/my_first_dag.py
[2022-06-16 00:48:31,580] {logging_mixin.py:109} INFO - [2022-06-16 00:48:31,580] {dag.py:2398} INFO - Sync 1 DAGs
[2022-06-16 00:48:31,594] {logging_mixin.py:109} INFO - [2022-06-16 00:48:31,594] {dag.py:2937} INFO - Setting next_dagrun for my_first_dag to None
[2022-06-16 00:48:31,612] {processor.py:171} INFO - Processing /home/leizo/airflow/dags/my_first_dag.py took 17.328 seconds
[2022-06-16 00:50:10,813] {processor.py:163} INFO - Started process (PID=15533) to work on /home/leizo/airflow/dags/my_first_dag.py
[2022-06-16 00:50:10,829] {processor.py:642} INFO - Processing file /home/leizo/airflow/dags/my_first_dag.py for tasks to queue
[2022-06-16 00:50:10,832] {logging_mixin.py:109} INFO - [2022-06-16 00:50:10,832] {dagbag.py:500} INFO - Filling up the DagBag from /home/leizo/airflow/dags/my_first_dag.py
[2022-06-16 00:50:33,928] {logging_mixin.py:109} INFO - paquet already exists topArtist rock 20220616
[2022-06-16 00:50:34,439] {logging_mixin.py:109} INFO - paquet already exists topArtist indie 20220616
[2022-06-16 00:50:35,008] {logging_mixin.py:109} INFO - paquet already exists topArtist indie rock 20220616
[2022-06-16 00:50:35,355] {logging_mixin.py:109} INFO - paquet already exists topArtist alternative 20220616
[2022-06-16 00:50:35,804] {logging_mixin.py:109} INFO - paquet already exists topArtist pop 20220616
[2022-06-16 00:50:36,206] {logging_mixin.py:109} INFO - paquet already exists topTracks rock 20220616
[2022-06-16 00:50:36,619] {logging_mixin.py:109} INFO - paquet already exists topTracks indie 20220616
[2022-06-16 00:50:37,027] {logging_mixin.py:109} INFO - paquet already exists topTracks indie rock 20220616
[2022-06-16 00:50:37,351] {logging_mixin.py:109} INFO - paquet already exists topTracks alternative 20220616
[2022-06-16 00:50:37,808] {logging_mixin.py:109} INFO - paquet already exists topTracks pop 20220616
[2022-06-16 00:50:37,814] {processor.py:652} INFO - DAG(s) dict_keys(['my_first_dag']) retrieved from /home/leizo/airflow/dags/my_first_dag.py
[2022-06-16 00:50:37,832] {logging_mixin.py:109} INFO - [2022-06-16 00:50:37,832] {dag.py:2398} INFO - Sync 1 DAGs
[2022-06-16 00:50:37,863] {logging_mixin.py:109} INFO - [2022-06-16 00:50:37,863] {dag.py:2937} INFO - Setting next_dagrun for my_first_dag to None
[2022-06-16 00:50:37,887] {processor.py:171} INFO - Processing /home/leizo/airflow/dags/my_first_dag.py took 27.107 seconds
[2022-06-16 00:52:29,397] {processor.py:163} INFO - Started process (PID=19209) to work on /home/leizo/airflow/dags/my_first_dag.py
[2022-06-16 00:52:29,400] {processor.py:642} INFO - Processing file /home/leizo/airflow/dags/my_first_dag.py for tasks to queue
[2022-06-16 00:52:29,402] {logging_mixin.py:109} INFO - [2022-06-16 00:52:29,401] {dagbag.py:500} INFO - Filling up the DagBag from /home/leizo/airflow/dags/my_first_dag.py
[2022-06-16 00:52:49,831] {logging_mixin.py:109} INFO - paquet already exists topArtist rock 20220616
[2022-06-16 00:52:50,367] {logging_mixin.py:109} INFO - paquet already exists topArtist indie 20220616
[2022-06-16 00:52:51,067] {logging_mixin.py:109} INFO - paquet already exists topArtist indie rock 20220616
[2022-06-16 00:52:51,609] {logging_mixin.py:109} INFO - paquet already exists topArtist alternative 20220616
[2022-06-16 00:52:52,124] {logging_mixin.py:109} INFO - paquet already exists topArtist pop 20220616
[2022-06-16 00:52:52,730] {logging_mixin.py:109} INFO - paquet already exists topTracks rock 20220616
[2022-06-16 00:52:53,355] {logging_mixin.py:109} INFO - paquet already exists topTracks indie 20220616
[2022-06-16 00:52:53,918] {logging_mixin.py:109} INFO - paquet already exists topTracks indie rock 20220616
[2022-06-16 00:52:54,511] {logging_mixin.py:109} INFO - paquet already exists topTracks alternative 20220616
[2022-06-16 00:52:55,074] {logging_mixin.py:109} INFO - paquet already exists topTracks pop 20220616
[2022-06-16 00:52:55,082] {processor.py:652} INFO - DAG(s) dict_keys(['my_first_dag']) retrieved from /home/leizo/airflow/dags/my_first_dag.py
[2022-06-16 00:52:55,103] {logging_mixin.py:109} INFO - [2022-06-16 00:52:55,103] {dag.py:2398} INFO - Sync 1 DAGs
[2022-06-16 00:52:55,125] {logging_mixin.py:109} INFO - [2022-06-16 00:52:55,125] {dag.py:2937} INFO - Setting next_dagrun for my_first_dag to None
[2022-06-16 00:52:55,152] {processor.py:171} INFO - Processing /home/leizo/airflow/dags/my_first_dag.py took 25.762 seconds
[2022-06-16 00:54:13,241] {processor.py:163} INFO - Started process (PID=20241) to work on /home/leizo/airflow/dags/my_first_dag.py
[2022-06-16 00:54:13,243] {processor.py:642} INFO - Processing file /home/leizo/airflow/dags/my_first_dag.py for tasks to queue
[2022-06-16 00:54:13,244] {logging_mixin.py:109} INFO - [2022-06-16 00:54:13,244] {dagbag.py:500} INFO - Filling up the DagBag from /home/leizo/airflow/dags/my_first_dag.py
[2022-06-16 00:54:31,272] {logging_mixin.py:109} INFO - paquet already exists topArtist rock 20220616
[2022-06-16 00:54:31,769] {logging_mixin.py:109} INFO - paquet already exists topArtist indie 20220616
[2022-06-16 00:54:32,322] {logging_mixin.py:109} INFO - paquet already exists topArtist indie rock 20220616
[2022-06-16 00:54:32,806] {logging_mixin.py:109} INFO - paquet already exists topArtist alternative 20220616
[2022-06-16 00:54:33,224] {logging_mixin.py:109} INFO - paquet already exists topArtist pop 20220616
[2022-06-16 00:54:33,723] {logging_mixin.py:109} INFO - paquet already exists topTracks rock 20220616
[2022-06-16 00:54:34,202] {logging_mixin.py:109} INFO - paquet already exists topTracks indie 20220616
[2022-06-16 00:54:34,656] {logging_mixin.py:109} INFO - paquet already exists topTracks indie rock 20220616
[2022-06-16 00:54:35,117] {logging_mixin.py:109} INFO - paquet already exists topTracks alternative 20220616
[2022-06-16 00:54:35,578] {logging_mixin.py:109} INFO - paquet already exists topTracks pop 20220616
[2022-06-16 00:54:35,582] {processor.py:652} INFO - DAG(s) dict_keys(['my_first_dag']) retrieved from /home/leizo/airflow/dags/my_first_dag.py
[2022-06-16 00:54:35,604] {logging_mixin.py:109} INFO - [2022-06-16 00:54:35,603] {dag.py:2398} INFO - Sync 1 DAGs
[2022-06-16 00:54:35,625] {logging_mixin.py:109} INFO - [2022-06-16 00:54:35,625] {dag.py:2937} INFO - Setting next_dagrun for my_first_dag to None
[2022-06-16 00:54:35,647] {processor.py:171} INFO - Processing /home/leizo/airflow/dags/my_first_dag.py took 22.409 seconds
[2022-06-16 00:56:18,820] {processor.py:163} INFO - Started process (PID=21299) to work on /home/leizo/airflow/dags/my_first_dag.py
[2022-06-16 00:56:18,824] {processor.py:642} INFO - Processing file /home/leizo/airflow/dags/my_first_dag.py for tasks to queue
[2022-06-16 00:56:18,825] {logging_mixin.py:109} INFO - [2022-06-16 00:56:18,825] {dagbag.py:500} INFO - Filling up the DagBag from /home/leizo/airflow/dags/my_first_dag.py
[2022-06-16 00:56:37,421] {logging_mixin.py:109} INFO - paquet already exists topArtist rock 20220616
[2022-06-16 00:56:37,971] {logging_mixin.py:109} INFO - paquet already exists topArtist indie 20220616
[2022-06-16 00:56:38,623] {logging_mixin.py:109} INFO - paquet already exists topArtist indie rock 20220616
[2022-06-16 00:56:39,154] {logging_mixin.py:109} INFO - paquet already exists topArtist alternative 20220616
[2022-06-16 00:56:39,644] {logging_mixin.py:109} INFO - paquet already exists topArtist pop 20220616
[2022-06-16 00:56:40,169] {logging_mixin.py:109} INFO - paquet already exists topTracks rock 20220616
[2022-06-16 00:56:40,665] {logging_mixin.py:109} INFO - paquet already exists topTracks indie 20220616
[2022-06-16 00:56:41,194] {logging_mixin.py:109} INFO - paquet already exists topTracks indie rock 20220616
[2022-06-16 00:56:41,669] {logging_mixin.py:109} INFO - paquet already exists topTracks alternative 20220616
[2022-06-16 00:56:42,140] {logging_mixin.py:109} INFO - paquet already exists topTracks pop 20220616
[2022-06-16 00:56:42,144] {processor.py:652} INFO - DAG(s) dict_keys(['my_first_dag']) retrieved from /home/leizo/airflow/dags/my_first_dag.py
[2022-06-16 00:56:42,162] {logging_mixin.py:109} INFO - [2022-06-16 00:56:42,161] {dag.py:2398} INFO - Sync 1 DAGs
[2022-06-16 00:56:42,181] {logging_mixin.py:109} INFO - [2022-06-16 00:56:42,181] {dag.py:2937} INFO - Setting next_dagrun for my_first_dag to None
[2022-06-16 00:56:42,203] {processor.py:171} INFO - Processing /home/leizo/airflow/dags/my_first_dag.py took 23.387 seconds
