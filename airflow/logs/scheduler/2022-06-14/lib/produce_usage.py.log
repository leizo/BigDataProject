[2022-06-14 20:02:57,488] {processor.py:163} INFO - Started process (PID=31656) to work on /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 20:02:57,489] {processor.py:642} INFO - Processing file /home/leizo/airflow/dags/lib/produce_usage.py for tasks to queue
[2022-06-14 20:02:57,490] {logging_mixin.py:109} INFO - [2022-06-14 20:02:57,490] {dagbag.py:500} INFO - Filling up the DagBag from /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 20:03:08,490] {logging_mixin.py:109} INFO - [DataFrame[artist: string, duration_s: bigint, name: string, rank_tag_rock: bigint], DataFrame[artist: string, duration_s: bigint, name: string, rank_tag_indie: bigint], DataFrame[artist: string, duration_s: bigint, name: string, rank_tag_alternative: bigint], DataFrame[artist: string, duration_s: bigint, name: string, rank_tag_pop: bigint]]
[2022-06-14 20:03:10,137] {logging_mixin.py:109} INFO - [DataFrame[album_name: string, album_total_tracks: bigint, artist: string, duration_ms: bigint, name: string, popularity: bigint, release_date: date, track_number: bigint], DataFrame[album_name: string, album_total_tracks: bigint, artist: string, duration_ms: bigint, name: string, popularity: bigint, release_date: date, track_number: bigint], DataFrame[album_name: string, album_total_tracks: bigint, artist: string, duration_ms: bigint, name: string, popularity: bigint, release_date: date, track_number: bigint], DataFrame[album_name: string, album_total_tracks: bigint, artist: string, duration_ms: bigint, name: string, popularity: bigint, release_date: date, track_number: bigint], DataFrame[album_name: string, album_total_tracks: bigint, artist: string, duration_ms: bigint, name: string, popularity: bigint, release_date: date, track_number: bigint], DataFrame[album_name: string, album_total_tracks: bigint, artist: string, duration_ms: bigint, name: string, popularity: bigint, release_date: date, track_number: bigint], DataFrame[album_name: string, album_total_tracks: bigint, artist: string, duration_ms: bigint, name: string, popularity: bigint, release_date: date, track_number: bigint], DataFrame[album_name: string, album_total_tracks: bigint, artist: string, duration_ms: bigint, name: string, popularity: bigint, release_date: date, track_number: bigint], DataFrame[album_name: string, album_total_tracks: bigint, artist: string, duration_ms: bigint, name: string, popularity: bigint, release_date: date, track_number: bigint], DataFrame[album_name: string, album_total_tracks: bigint, artist: string, duration_ms: bigint, name: string, popularity: bigint, release_date: date, track_number: bigint]]
[2022-06-14 20:03:10,137] {processor.py:654} WARNING - No viable dags retrieved from /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 20:03:10,145] {processor.py:171} INFO - Processing /home/leizo/airflow/dags/lib/produce_usage.py took 12.659 seconds
[2022-06-14 20:03:46,108] {processor.py:163} INFO - Started process (PID=32294) to work on /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 20:03:46,110] {processor.py:642} INFO - Processing file /home/leizo/airflow/dags/lib/produce_usage.py for tasks to queue
[2022-06-14 20:03:46,110] {logging_mixin.py:109} INFO - [2022-06-14 20:03:46,110] {dagbag.py:500} INFO - Filling up the DagBag from /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 20:03:57,620] {logging_mixin.py:109} INFO - [DataFrame[artist: string, duration_s: bigint, name: string, rank_tag_rock: bigint], DataFrame[artist: string, duration_s: bigint, name: string, rank_tag_indie: bigint], DataFrame[artist: string, duration_s: bigint, name: string, rank_tag_alternative: bigint], DataFrame[artist: string, duration_s: bigint, name: string, rank_tag_pop: bigint]]
[2022-06-14 20:03:59,315] {logging_mixin.py:109} INFO - [DataFrame[album_name: string, album_total_tracks: bigint, artist: string, duration_ms: bigint, name: string, popularity: bigint, release_date: date, track_number: bigint], DataFrame[album_name: string, album_total_tracks: bigint, artist: string, duration_ms: bigint, name: string, popularity: bigint, release_date: date, track_number: bigint], DataFrame[album_name: string, album_total_tracks: bigint, artist: string, duration_ms: bigint, name: string, popularity: bigint, release_date: date, track_number: bigint], DataFrame[album_name: string, album_total_tracks: bigint, artist: string, duration_ms: bigint, name: string, popularity: bigint, release_date: date, track_number: bigint], DataFrame[album_name: string, album_total_tracks: bigint, artist: string, duration_ms: bigint, name: string, popularity: bigint, release_date: date, track_number: bigint], DataFrame[album_name: string, album_total_tracks: bigint, artist: string, duration_ms: bigint, name: string, popularity: bigint, release_date: date, track_number: bigint], DataFrame[album_name: string, album_total_tracks: bigint, artist: string, duration_ms: bigint, name: string, popularity: bigint, release_date: date, track_number: bigint], DataFrame[album_name: string, album_total_tracks: bigint, artist: string, duration_ms: bigint, name: string, popularity: bigint, release_date: date, track_number: bigint], DataFrame[album_name: string, album_total_tracks: bigint, artist: string, duration_ms: bigint, name: string, popularity: bigint, release_date: date, track_number: bigint], DataFrame[album_name: string, album_total_tracks: bigint, artist: string, duration_ms: bigint, name: string, popularity: bigint, release_date: date, track_number: bigint]]
[2022-06-14 20:03:59,316] {processor.py:654} WARNING - No viable dags retrieved from /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 20:03:59,328] {processor.py:171} INFO - Processing /home/leizo/airflow/dags/lib/produce_usage.py took 13.222 seconds
[2022-06-14 20:04:56,231] {processor.py:163} INFO - Started process (PID=485) to work on /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 20:04:56,236] {processor.py:642} INFO - Processing file /home/leizo/airflow/dags/lib/produce_usage.py for tasks to queue
[2022-06-14 20:04:56,238] {logging_mixin.py:109} INFO - [2022-06-14 20:04:56,238] {dagbag.py:500} INFO - Filling up the DagBag from /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 20:05:13,161] {logging_mixin.py:109} INFO - [DataFrame[artist: string, duration_s: bigint, name: string, rank_tag_rock: bigint], DataFrame[artist: string, duration_s: bigint, name: string, rank_tag_indie: bigint], DataFrame[artist: string, duration_s: bigint, name: string, rank_tag_alternative: bigint], DataFrame[artist: string, duration_s: bigint, name: string, rank_tag_pop: bigint]]
[2022-06-14 20:05:15,810] {logging_mixin.py:109} INFO - [DataFrame[album_name: string, album_total_tracks: bigint, artist: string, duration_ms: bigint, name: string, popularity: bigint, release_date: date, track_number: bigint], DataFrame[album_name: string, album_total_tracks: bigint, artist: string, duration_ms: bigint, name: string, popularity: bigint, release_date: date, track_number: bigint], DataFrame[album_name: string, album_total_tracks: bigint, artist: string, duration_ms: bigint, name: string, popularity: bigint, release_date: date, track_number: bigint], DataFrame[album_name: string, album_total_tracks: bigint, artist: string, duration_ms: bigint, name: string, popularity: bigint, release_date: date, track_number: bigint], DataFrame[album_name: string, album_total_tracks: bigint, artist: string, duration_ms: bigint, name: string, popularity: bigint, release_date: date, track_number: bigint], DataFrame[album_name: string, album_total_tracks: bigint, artist: string, duration_ms: bigint, name: string, popularity: bigint, release_date: date, track_number: bigint], DataFrame[album_name: string, album_total_tracks: bigint, artist: string, duration_ms: bigint, name: string, popularity: bigint, release_date: date, track_number: bigint], DataFrame[album_name: string, album_total_tracks: bigint, artist: string, duration_ms: bigint, name: string, popularity: bigint, release_date: date, track_number: bigint], DataFrame[album_name: string, album_total_tracks: bigint, artist: string, duration_ms: bigint, name: string, popularity: bigint, release_date: date, track_number: bigint], DataFrame[album_name: string, album_total_tracks: bigint, artist: string, duration_ms: bigint, name: string, popularity: bigint, release_date: date, track_number: bigint]]
[2022-06-14 20:05:15,811] {processor.py:654} WARNING - No viable dags retrieved from /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 20:05:15,832] {processor.py:171} INFO - Processing /home/leizo/airflow/dags/lib/produce_usage.py took 19.606 seconds
[2022-06-14 20:05:59,466] {processor.py:163} INFO - Started process (PID=1126) to work on /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 20:05:59,470] {processor.py:642} INFO - Processing file /home/leizo/airflow/dags/lib/produce_usage.py for tasks to queue
[2022-06-14 20:05:59,478] {logging_mixin.py:109} INFO - [2022-06-14 20:05:59,477] {dagbag.py:500} INFO - Filling up the DagBag from /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 20:06:17,410] {logging_mixin.py:109} INFO - [DataFrame[artist: string, duration_s: bigint, name: string, rank_tag_rock: bigint], DataFrame[artist: string, duration_s: bigint, name: string, rank_tag_indie: bigint], DataFrame[artist: string, duration_s: bigint, name: string, rank_tag_alternative: bigint], DataFrame[artist: string, duration_s: bigint, name: string, rank_tag_pop: bigint]]
[2022-06-14 20:06:19,221] {logging_mixin.py:109} INFO - [DataFrame[album_name: string, album_total_tracks: bigint, artist: string, duration_ms: bigint, name: string, popularity: bigint, release_date: date, track_number: bigint], DataFrame[album_name: string, album_total_tracks: bigint, artist: string, duration_ms: bigint, name: string, popularity: bigint, release_date: date, track_number: bigint], DataFrame[album_name: string, album_total_tracks: bigint, artist: string, duration_ms: bigint, name: string, popularity: bigint, release_date: date, track_number: bigint], DataFrame[album_name: string, album_total_tracks: bigint, artist: string, duration_ms: bigint, name: string, popularity: bigint, release_date: date, track_number: bigint], DataFrame[album_name: string, album_total_tracks: bigint, artist: string, duration_ms: bigint, name: string, popularity: bigint, release_date: date, track_number: bigint], DataFrame[album_name: string, album_total_tracks: bigint, artist: string, duration_ms: bigint, name: string, popularity: bigint, release_date: date, track_number: bigint], DataFrame[album_name: string, album_total_tracks: bigint, artist: string, duration_ms: bigint, name: string, popularity: bigint, release_date: date, track_number: bigint], DataFrame[album_name: string, album_total_tracks: bigint, artist: string, duration_ms: bigint, name: string, popularity: bigint, release_date: date, track_number: bigint], DataFrame[album_name: string, album_total_tracks: bigint, artist: string, duration_ms: bigint, name: string, popularity: bigint, release_date: date, track_number: bigint], DataFrame[album_name: string, album_total_tracks: bigint, artist: string, duration_ms: bigint, name: string, popularity: bigint, release_date: date, track_number: bigint]]
[2022-06-14 20:06:19,221] {processor.py:654} WARNING - No viable dags retrieved from /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 20:06:19,230] {processor.py:171} INFO - Processing /home/leizo/airflow/dags/lib/produce_usage.py took 19.770 seconds
[2022-06-14 20:07:15,701] {processor.py:163} INFO - Started process (PID=1792) to work on /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 20:07:15,704] {processor.py:642} INFO - Processing file /home/leizo/airflow/dags/lib/produce_usage.py for tasks to queue
[2022-06-14 20:07:15,705] {logging_mixin.py:109} INFO - [2022-06-14 20:07:15,705] {dagbag.py:500} INFO - Filling up the DagBag from /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 20:07:33,656] {logging_mixin.py:109} INFO - [DataFrame[artist: string, duration_s: bigint, name: string, rank_tag_rock: bigint], DataFrame[artist: string, duration_s: bigint, name: string, rank_tag_indie: bigint], DataFrame[artist: string, duration_s: bigint, name: string, rank_tag_alternative: bigint], DataFrame[artist: string, duration_s: bigint, name: string, rank_tag_pop: bigint]]
[2022-06-14 20:07:36,663] {logging_mixin.py:109} INFO - [DataFrame[album_name: string, album_total_tracks: bigint, artist: string, duration_ms: bigint, name: string, popularity: bigint, release_date: date, track_number: bigint], DataFrame[album_name: string, album_total_tracks: bigint, artist: string, duration_ms: bigint, name: string, popularity: bigint, release_date: date, track_number: bigint], DataFrame[album_name: string, album_total_tracks: bigint, artist: string, duration_ms: bigint, name: string, popularity: bigint, release_date: date, track_number: bigint], DataFrame[album_name: string, album_total_tracks: bigint, artist: string, duration_ms: bigint, name: string, popularity: bigint, release_date: date, track_number: bigint], DataFrame[album_name: string, album_total_tracks: bigint, artist: string, duration_ms: bigint, name: string, popularity: bigint, release_date: date, track_number: bigint], DataFrame[album_name: string, album_total_tracks: bigint, artist: string, duration_ms: bigint, name: string, popularity: bigint, release_date: date, track_number: bigint], DataFrame[album_name: string, album_total_tracks: bigint, artist: string, duration_ms: bigint, name: string, popularity: bigint, release_date: date, track_number: bigint], DataFrame[album_name: string, album_total_tracks: bigint, artist: string, duration_ms: bigint, name: string, popularity: bigint, release_date: date, track_number: bigint], DataFrame[album_name: string, album_total_tracks: bigint, artist: string, duration_ms: bigint, name: string, popularity: bigint, release_date: date, track_number: bigint], DataFrame[album_name: string, album_total_tracks: bigint, artist: string, duration_ms: bigint, name: string, popularity: bigint, release_date: date, track_number: bigint]]
[2022-06-14 20:07:36,664] {processor.py:654} WARNING - No viable dags retrieved from /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 20:07:36,686] {processor.py:171} INFO - Processing /home/leizo/airflow/dags/lib/produce_usage.py took 20.987 seconds
[2022-06-14 20:08:13,926] {processor.py:163} INFO - Started process (PID=2437) to work on /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 20:08:13,930] {processor.py:642} INFO - Processing file /home/leizo/airflow/dags/lib/produce_usage.py for tasks to queue
[2022-06-14 20:08:13,931] {logging_mixin.py:109} INFO - [2022-06-14 20:08:13,931] {dagbag.py:500} INFO - Filling up the DagBag from /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 20:08:27,445] {logging_mixin.py:109} INFO - [DataFrame[artist: string, duration_s: bigint, name: string, rank_tag_rock: bigint], DataFrame[artist: string, duration_s: bigint, name: string, rank_tag_indie: bigint], DataFrame[artist: string, duration_s: bigint, name: string, rank_tag_alternative: bigint], DataFrame[artist: string, duration_s: bigint, name: string, rank_tag_pop: bigint]]
[2022-06-14 20:08:29,440] {logging_mixin.py:109} INFO - [DataFrame[album_name: string, album_total_tracks: bigint, artist: string, duration_ms: bigint, name: string, popularity: bigint, release_date: date, track_number: bigint], DataFrame[album_name: string, album_total_tracks: bigint, artist: string, duration_ms: bigint, name: string, popularity: bigint, release_date: date, track_number: bigint], DataFrame[album_name: string, album_total_tracks: bigint, artist: string, duration_ms: bigint, name: string, popularity: bigint, release_date: date, track_number: bigint], DataFrame[album_name: string, album_total_tracks: bigint, artist: string, duration_ms: bigint, name: string, popularity: bigint, release_date: date, track_number: bigint], DataFrame[album_name: string, album_total_tracks: bigint, artist: string, duration_ms: bigint, name: string, popularity: bigint, release_date: date, track_number: bigint], DataFrame[album_name: string, album_total_tracks: bigint, artist: string, duration_ms: bigint, name: string, popularity: bigint, release_date: date, track_number: bigint], DataFrame[album_name: string, album_total_tracks: bigint, artist: string, duration_ms: bigint, name: string, popularity: bigint, release_date: date, track_number: bigint], DataFrame[album_name: string, album_total_tracks: bigint, artist: string, duration_ms: bigint, name: string, popularity: bigint, release_date: date, track_number: bigint], DataFrame[album_name: string, album_total_tracks: bigint, artist: string, duration_ms: bigint, name: string, popularity: bigint, release_date: date, track_number: bigint], DataFrame[album_name: string, album_total_tracks: bigint, artist: string, duration_ms: bigint, name: string, popularity: bigint, release_date: date, track_number: bigint]]
[2022-06-14 20:08:29,440] {processor.py:654} WARNING - No viable dags retrieved from /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 20:08:29,456] {processor.py:171} INFO - Processing /home/leizo/airflow/dags/lib/produce_usage.py took 15.536 seconds
[2022-06-14 20:09:21,334] {processor.py:163} INFO - Started process (PID=3110) to work on /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 20:09:21,336] {processor.py:642} INFO - Processing file /home/leizo/airflow/dags/lib/produce_usage.py for tasks to queue
[2022-06-14 20:09:21,337] {logging_mixin.py:109} INFO - [2022-06-14 20:09:21,337] {dagbag.py:500} INFO - Filling up the DagBag from /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 20:09:32,968] {logging_mixin.py:109} INFO - [DataFrame[artist: string, duration_s: bigint, name: string, rank_tag_rock: bigint], DataFrame[artist: string, duration_s: bigint, name: string, rank_tag_indie: bigint], DataFrame[artist: string, duration_s: bigint, name: string, rank_tag_alternative: bigint], DataFrame[artist: string, duration_s: bigint, name: string, rank_tag_pop: bigint]]
[2022-06-14 20:09:34,706] {logging_mixin.py:109} INFO - [DataFrame[album_name: string, album_total_tracks: bigint, artist: string, duration_ms: bigint, name: string, popularity: bigint, release_date: date, track_number: bigint], DataFrame[album_name: string, album_total_tracks: bigint, artist: string, duration_ms: bigint, name: string, popularity: bigint, release_date: date, track_number: bigint], DataFrame[album_name: string, album_total_tracks: bigint, artist: string, duration_ms: bigint, name: string, popularity: bigint, release_date: date, track_number: bigint], DataFrame[album_name: string, album_total_tracks: bigint, artist: string, duration_ms: bigint, name: string, popularity: bigint, release_date: date, track_number: bigint], DataFrame[album_name: string, album_total_tracks: bigint, artist: string, duration_ms: bigint, name: string, popularity: bigint, release_date: date, track_number: bigint], DataFrame[album_name: string, album_total_tracks: bigint, artist: string, duration_ms: bigint, name: string, popularity: bigint, release_date: date, track_number: bigint], DataFrame[album_name: string, album_total_tracks: bigint, artist: string, duration_ms: bigint, name: string, popularity: bigint, release_date: date, track_number: bigint], DataFrame[album_name: string, album_total_tracks: bigint, artist: string, duration_ms: bigint, name: string, popularity: bigint, release_date: date, track_number: bigint], DataFrame[album_name: string, album_total_tracks: bigint, artist: string, duration_ms: bigint, name: string, popularity: bigint, release_date: date, track_number: bigint], DataFrame[album_name: string, album_total_tracks: bigint, artist: string, duration_ms: bigint, name: string, popularity: bigint, release_date: date, track_number: bigint]]
[2022-06-14 20:09:34,707] {logging_mixin.py:109} INFO - [2022-06-14 20:09:34,706] {dagbag.py:334} ERROR - Failed to import: /home/leizo/airflow/dags/lib/produce_usage.py
Traceback (most recent call last):
  File "/home/leizo/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 848, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/home/leizo/airflow/dags/lib/produce_usage.py", line 62, in <module>
    DF_rock_playlists = [].toDF()
AttributeError: 'list' object has no attribute 'toDF'
[2022-06-14 20:09:34,708] {processor.py:654} WARNING - No viable dags retrieved from /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 20:09:34,726] {processor.py:171} INFO - Processing /home/leizo/airflow/dags/lib/produce_usage.py took 13.395 seconds
[2022-06-14 20:10:13,288] {processor.py:163} INFO - Started process (PID=3745) to work on /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 20:10:13,290] {processor.py:642} INFO - Processing file /home/leizo/airflow/dags/lib/produce_usage.py for tasks to queue
[2022-06-14 20:10:13,291] {logging_mixin.py:109} INFO - [2022-06-14 20:10:13,291] {dagbag.py:500} INFO - Filling up the DagBag from /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 20:10:26,865] {logging_mixin.py:109} INFO - [DataFrame[artist: string, duration_s: bigint, name: string, rank_tag_rock: bigint], DataFrame[artist: string, duration_s: bigint, name: string, rank_tag_indie: bigint], DataFrame[artist: string, duration_s: bigint, name: string, rank_tag_alternative: bigint], DataFrame[artist: string, duration_s: bigint, name: string, rank_tag_pop: bigint]]
[2022-06-14 20:10:28,810] {logging_mixin.py:109} INFO - [DataFrame[album_name: string, album_total_tracks: bigint, artist: string, duration_ms: bigint, name: string, popularity: bigint, release_date: date, track_number: bigint], DataFrame[album_name: string, album_total_tracks: bigint, artist: string, duration_ms: bigint, name: string, popularity: bigint, release_date: date, track_number: bigint], DataFrame[album_name: string, album_total_tracks: bigint, artist: string, duration_ms: bigint, name: string, popularity: bigint, release_date: date, track_number: bigint], DataFrame[album_name: string, album_total_tracks: bigint, artist: string, duration_ms: bigint, name: string, popularity: bigint, release_date: date, track_number: bigint], DataFrame[album_name: string, album_total_tracks: bigint, artist: string, duration_ms: bigint, name: string, popularity: bigint, release_date: date, track_number: bigint], DataFrame[album_name: string, album_total_tracks: bigint, artist: string, duration_ms: bigint, name: string, popularity: bigint, release_date: date, track_number: bigint], DataFrame[album_name: string, album_total_tracks: bigint, artist: string, duration_ms: bigint, name: string, popularity: bigint, release_date: date, track_number: bigint], DataFrame[album_name: string, album_total_tracks: bigint, artist: string, duration_ms: bigint, name: string, popularity: bigint, release_date: date, track_number: bigint], DataFrame[album_name: string, album_total_tracks: bigint, artist: string, duration_ms: bigint, name: string, popularity: bigint, release_date: date, track_number: bigint], DataFrame[album_name: string, album_total_tracks: bigint, artist: string, duration_ms: bigint, name: string, popularity: bigint, release_date: date, track_number: bigint]]
[2022-06-14 20:10:28,812] {logging_mixin.py:109} INFO - [2022-06-14 20:10:28,810] {dagbag.py:334} ERROR - Failed to import: /home/leizo/airflow/dags/lib/produce_usage.py
Traceback (most recent call last):
  File "/home/leizo/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 848, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/home/leizo/airflow/dags/lib/produce_usage.py", line 62, in <module>
    DF_rock_playlists = [].toDF()
AttributeError: 'list' object has no attribute 'toDF'
[2022-06-14 20:10:28,813] {processor.py:654} WARNING - No viable dags retrieved from /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 20:10:28,851] {processor.py:171} INFO - Processing /home/leizo/airflow/dags/lib/produce_usage.py took 15.565 seconds
[2022-06-14 20:11:19,764] {processor.py:163} INFO - Started process (PID=4409) to work on /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 20:11:19,766] {processor.py:642} INFO - Processing file /home/leizo/airflow/dags/lib/produce_usage.py for tasks to queue
[2022-06-14 20:11:19,767] {logging_mixin.py:109} INFO - [2022-06-14 20:11:19,767] {dagbag.py:500} INFO - Filling up the DagBag from /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 20:11:31,251] {logging_mixin.py:109} INFO - [DataFrame[artist: string, duration_s: bigint, name: string, rank_tag_rock: bigint], DataFrame[artist: string, duration_s: bigint, name: string, rank_tag_indie: bigint], DataFrame[artist: string, duration_s: bigint, name: string, rank_tag_alternative: bigint], DataFrame[artist: string, duration_s: bigint, name: string, rank_tag_pop: bigint]]
[2022-06-14 20:11:32,999] {logging_mixin.py:109} INFO - [DataFrame[album_name: string, album_total_tracks: bigint, artist: string, duration_ms: bigint, name: string, popularity: bigint, release_date: date, track_number: bigint], DataFrame[album_name: string, album_total_tracks: bigint, artist: string, duration_ms: bigint, name: string, popularity: bigint, release_date: date, track_number: bigint], DataFrame[album_name: string, album_total_tracks: bigint, artist: string, duration_ms: bigint, name: string, popularity: bigint, release_date: date, track_number: bigint], DataFrame[album_name: string, album_total_tracks: bigint, artist: string, duration_ms: bigint, name: string, popularity: bigint, release_date: date, track_number: bigint], DataFrame[album_name: string, album_total_tracks: bigint, artist: string, duration_ms: bigint, name: string, popularity: bigint, release_date: date, track_number: bigint], DataFrame[album_name: string, album_total_tracks: bigint, artist: string, duration_ms: bigint, name: string, popularity: bigint, release_date: date, track_number: bigint], DataFrame[album_name: string, album_total_tracks: bigint, artist: string, duration_ms: bigint, name: string, popularity: bigint, release_date: date, track_number: bigint], DataFrame[album_name: string, album_total_tracks: bigint, artist: string, duration_ms: bigint, name: string, popularity: bigint, release_date: date, track_number: bigint], DataFrame[album_name: string, album_total_tracks: bigint, artist: string, duration_ms: bigint, name: string, popularity: bigint, release_date: date, track_number: bigint], DataFrame[album_name: string, album_total_tracks: bigint, artist: string, duration_ms: bigint, name: string, popularity: bigint, release_date: date, track_number: bigint]]
[2022-06-14 20:11:33,002] {logging_mixin.py:109} INFO - [2022-06-14 20:11:33,000] {dagbag.py:334} ERROR - Failed to import: /home/leizo/airflow/dags/lib/produce_usage.py
Traceback (most recent call last):
  File "/home/leizo/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 848, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/home/leizo/airflow/dags/lib/produce_usage.py", line 62, in <module>
    DF_rock_playlists = [].toDF()
AttributeError: 'list' object has no attribute 'toDF'
[2022-06-14 20:11:33,003] {processor.py:654} WARNING - No viable dags retrieved from /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 20:11:33,029] {processor.py:171} INFO - Processing /home/leizo/airflow/dags/lib/produce_usage.py took 13.267 seconds
[2022-06-14 20:12:10,635] {processor.py:163} INFO - Started process (PID=5051) to work on /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 20:12:10,638] {processor.py:642} INFO - Processing file /home/leizo/airflow/dags/lib/produce_usage.py for tasks to queue
[2022-06-14 20:12:10,638] {logging_mixin.py:109} INFO - [2022-06-14 20:12:10,638] {dagbag.py:500} INFO - Filling up the DagBag from /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 20:12:21,358] {logging_mixin.py:109} INFO - [DataFrame[artist: string, duration_s: bigint, name: string, rank_tag_rock: bigint], DataFrame[artist: string, duration_s: bigint, name: string, rank_tag_indie: bigint], DataFrame[artist: string, duration_s: bigint, name: string, rank_tag_alternative: bigint], DataFrame[artist: string, duration_s: bigint, name: string, rank_tag_pop: bigint]]
[2022-06-14 20:12:23,479] {logging_mixin.py:109} INFO - [DataFrame[album_name: string, album_total_tracks: bigint, artist: string, duration_ms: bigint, name: string, popularity: bigint, release_date: date, track_number: bigint], DataFrame[album_name: string, album_total_tracks: bigint, artist: string, duration_ms: bigint, name: string, popularity: bigint, release_date: date, track_number: bigint], DataFrame[album_name: string, album_total_tracks: bigint, artist: string, duration_ms: bigint, name: string, popularity: bigint, release_date: date, track_number: bigint], DataFrame[album_name: string, album_total_tracks: bigint, artist: string, duration_ms: bigint, name: string, popularity: bigint, release_date: date, track_number: bigint], DataFrame[album_name: string, album_total_tracks: bigint, artist: string, duration_ms: bigint, name: string, popularity: bigint, release_date: date, track_number: bigint], DataFrame[album_name: string, album_total_tracks: bigint, artist: string, duration_ms: bigint, name: string, popularity: bigint, release_date: date, track_number: bigint], DataFrame[album_name: string, album_total_tracks: bigint, artist: string, duration_ms: bigint, name: string, popularity: bigint, release_date: date, track_number: bigint], DataFrame[album_name: string, album_total_tracks: bigint, artist: string, duration_ms: bigint, name: string, popularity: bigint, release_date: date, track_number: bigint], DataFrame[album_name: string, album_total_tracks: bigint, artist: string, duration_ms: bigint, name: string, popularity: bigint, release_date: date, track_number: bigint], DataFrame[album_name: string, album_total_tracks: bigint, artist: string, duration_ms: bigint, name: string, popularity: bigint, release_date: date, track_number: bigint]]
[2022-06-14 20:12:23,480] {logging_mixin.py:109} INFO - [2022-06-14 20:12:23,479] {dagbag.py:334} ERROR - Failed to import: /home/leizo/airflow/dags/lib/produce_usage.py
Traceback (most recent call last):
  File "/home/leizo/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 848, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/home/leizo/airflow/dags/lib/produce_usage.py", line 62, in <module>
    DF_rock_playlists = [].toDF()
AttributeError: 'list' object has no attribute 'toDF'
[2022-06-14 20:12:23,481] {processor.py:654} WARNING - No viable dags retrieved from /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 20:12:23,502] {processor.py:171} INFO - Processing /home/leizo/airflow/dags/lib/produce_usage.py took 12.869 seconds
[2022-06-14 20:13:14,604] {processor.py:163} INFO - Started process (PID=5707) to work on /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 20:13:14,607] {processor.py:642} INFO - Processing file /home/leizo/airflow/dags/lib/produce_usage.py for tasks to queue
[2022-06-14 20:13:14,608] {logging_mixin.py:109} INFO - [2022-06-14 20:13:14,608] {dagbag.py:500} INFO - Filling up the DagBag from /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 20:13:24,812] {logging_mixin.py:109} INFO - [DataFrame[artist: string, duration_s: bigint, name: string, rank_tag_rock: bigint], DataFrame[artist: string, duration_s: bigint, name: string, rank_tag_indie: bigint], DataFrame[artist: string, duration_s: bigint, name: string, rank_tag_alternative: bigint], DataFrame[artist: string, duration_s: bigint, name: string, rank_tag_pop: bigint]]
[2022-06-14 20:13:26,278] {logging_mixin.py:109} INFO - [DataFrame[album_name: string, album_total_tracks: bigint, artist: string, duration_ms: bigint, name: string, popularity: bigint, release_date: date, track_number: bigint], DataFrame[album_name: string, album_total_tracks: bigint, artist: string, duration_ms: bigint, name: string, popularity: bigint, release_date: date, track_number: bigint], DataFrame[album_name: string, album_total_tracks: bigint, artist: string, duration_ms: bigint, name: string, popularity: bigint, release_date: date, track_number: bigint], DataFrame[album_name: string, album_total_tracks: bigint, artist: string, duration_ms: bigint, name: string, popularity: bigint, release_date: date, track_number: bigint], DataFrame[album_name: string, album_total_tracks: bigint, artist: string, duration_ms: bigint, name: string, popularity: bigint, release_date: date, track_number: bigint], DataFrame[album_name: string, album_total_tracks: bigint, artist: string, duration_ms: bigint, name: string, popularity: bigint, release_date: date, track_number: bigint], DataFrame[album_name: string, album_total_tracks: bigint, artist: string, duration_ms: bigint, name: string, popularity: bigint, release_date: date, track_number: bigint], DataFrame[album_name: string, album_total_tracks: bigint, artist: string, duration_ms: bigint, name: string, popularity: bigint, release_date: date, track_number: bigint], DataFrame[album_name: string, album_total_tracks: bigint, artist: string, duration_ms: bigint, name: string, popularity: bigint, release_date: date, track_number: bigint], DataFrame[album_name: string, album_total_tracks: bigint, artist: string, duration_ms: bigint, name: string, popularity: bigint, release_date: date, track_number: bigint]]
[2022-06-14 20:13:26,280] {logging_mixin.py:109} INFO - [2022-06-14 20:13:26,278] {dagbag.py:334} ERROR - Failed to import: /home/leizo/airflow/dags/lib/produce_usage.py
Traceback (most recent call last):
  File "/home/leizo/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 848, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/home/leizo/airflow/dags/lib/produce_usage.py", line 62, in <module>
    DF_rock_playlists = [].toDF()
AttributeError: 'list' object has no attribute 'toDF'
[2022-06-14 20:13:26,280] {processor.py:654} WARNING - No viable dags retrieved from /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 20:13:26,305] {processor.py:171} INFO - Processing /home/leizo/airflow/dags/lib/produce_usage.py took 11.704 seconds
[2022-06-14 20:14:00,756] {processor.py:163} INFO - Started process (PID=6426) to work on /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 20:14:00,759] {processor.py:642} INFO - Processing file /home/leizo/airflow/dags/lib/produce_usage.py for tasks to queue
[2022-06-14 20:14:00,760] {logging_mixin.py:109} INFO - [2022-06-14 20:14:00,760] {dagbag.py:500} INFO - Filling up the DagBag from /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 20:14:11,169] {logging_mixin.py:109} INFO - [DataFrame[artist: string, duration_s: bigint, name: string, rank_tag_rock: bigint], DataFrame[artist: string, duration_s: bigint, name: string, rank_tag_indie: bigint], DataFrame[artist: string, duration_s: bigint, name: string, rank_tag_alternative: bigint], DataFrame[artist: string, duration_s: bigint, name: string, rank_tag_pop: bigint]]
[2022-06-14 20:14:12,794] {logging_mixin.py:109} INFO - [DataFrame[album_name: string, album_total_tracks: bigint, artist: string, duration_ms: bigint, name: string, popularity: bigint, release_date: date, track_number: bigint], DataFrame[album_name: string, album_total_tracks: bigint, artist: string, duration_ms: bigint, name: string, popularity: bigint, release_date: date, track_number: bigint], DataFrame[album_name: string, album_total_tracks: bigint, artist: string, duration_ms: bigint, name: string, popularity: bigint, release_date: date, track_number: bigint], DataFrame[album_name: string, album_total_tracks: bigint, artist: string, duration_ms: bigint, name: string, popularity: bigint, release_date: date, track_number: bigint], DataFrame[album_name: string, album_total_tracks: bigint, artist: string, duration_ms: bigint, name: string, popularity: bigint, release_date: date, track_number: bigint], DataFrame[album_name: string, album_total_tracks: bigint, artist: string, duration_ms: bigint, name: string, popularity: bigint, release_date: date, track_number: bigint], DataFrame[album_name: string, album_total_tracks: bigint, artist: string, duration_ms: bigint, name: string, popularity: bigint, release_date: date, track_number: bigint], DataFrame[album_name: string, album_total_tracks: bigint, artist: string, duration_ms: bigint, name: string, popularity: bigint, release_date: date, track_number: bigint], DataFrame[album_name: string, album_total_tracks: bigint, artist: string, duration_ms: bigint, name: string, popularity: bigint, release_date: date, track_number: bigint], DataFrame[album_name: string, album_total_tracks: bigint, artist: string, duration_ms: bigint, name: string, popularity: bigint, release_date: date, track_number: bigint]]
[2022-06-14 20:14:12,796] {logging_mixin.py:109} INFO - [2022-06-14 20:14:12,795] {dagbag.py:334} ERROR - Failed to import: /home/leizo/airflow/dags/lib/produce_usage.py
Traceback (most recent call last):
  File "/home/leizo/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 848, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/home/leizo/airflow/dags/lib/produce_usage.py", line 62, in <module>
    DF_rock_playlists = [].toDF()
AttributeError: 'list' object has no attribute 'toDF'
[2022-06-14 20:14:12,796] {processor.py:654} WARNING - No viable dags retrieved from /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 20:14:12,815] {processor.py:171} INFO - Processing /home/leizo/airflow/dags/lib/produce_usage.py took 12.063 seconds
[2022-06-14 20:15:04,178] {processor.py:163} INFO - Started process (PID=7086) to work on /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 20:15:04,181] {processor.py:642} INFO - Processing file /home/leizo/airflow/dags/lib/produce_usage.py for tasks to queue
[2022-06-14 20:15:04,181] {logging_mixin.py:109} INFO - [2022-06-14 20:15:04,181] {dagbag.py:500} INFO - Filling up the DagBag from /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 20:15:14,912] {logging_mixin.py:109} INFO - [DataFrame[artist: string, duration_s: bigint, name: string, rank_tag_rock: bigint], DataFrame[artist: string, duration_s: bigint, name: string, rank_tag_indie: bigint], DataFrame[artist: string, duration_s: bigint, name: string, rank_tag_alternative: bigint], DataFrame[artist: string, duration_s: bigint, name: string, rank_tag_pop: bigint]]
[2022-06-14 20:15:17,214] {logging_mixin.py:109} INFO - [DataFrame[album_name: string, album_total_tracks: bigint, artist: string, duration_ms: bigint, name: string, popularity: bigint, release_date: date, track_number: bigint], DataFrame[album_name: string, album_total_tracks: bigint, artist: string, duration_ms: bigint, name: string, popularity: bigint, release_date: date, track_number: bigint], DataFrame[album_name: string, album_total_tracks: bigint, artist: string, duration_ms: bigint, name: string, popularity: bigint, release_date: date, track_number: bigint], DataFrame[album_name: string, album_total_tracks: bigint, artist: string, duration_ms: bigint, name: string, popularity: bigint, release_date: date, track_number: bigint], DataFrame[album_name: string, album_total_tracks: bigint, artist: string, duration_ms: bigint, name: string, popularity: bigint, release_date: date, track_number: bigint], DataFrame[album_name: string, album_total_tracks: bigint, artist: string, duration_ms: bigint, name: string, popularity: bigint, release_date: date, track_number: bigint], DataFrame[album_name: string, album_total_tracks: bigint, artist: string, duration_ms: bigint, name: string, popularity: bigint, release_date: date, track_number: bigint], DataFrame[album_name: string, album_total_tracks: bigint, artist: string, duration_ms: bigint, name: string, popularity: bigint, release_date: date, track_number: bigint], DataFrame[album_name: string, album_total_tracks: bigint, artist: string, duration_ms: bigint, name: string, popularity: bigint, release_date: date, track_number: bigint], DataFrame[album_name: string, album_total_tracks: bigint, artist: string, duration_ms: bigint, name: string, popularity: bigint, release_date: date, track_number: bigint]]
[2022-06-14 20:15:17,216] {logging_mixin.py:109} INFO - [2022-06-14 20:15:17,214] {dagbag.py:334} ERROR - Failed to import: /home/leizo/airflow/dags/lib/produce_usage.py
Traceback (most recent call last):
  File "/home/leizo/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 848, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/home/leizo/airflow/dags/lib/produce_usage.py", line 62, in <module>
    DF_rock_playlists = [].toDF()
AttributeError: 'list' object has no attribute 'toDF'
[2022-06-14 20:15:17,217] {processor.py:654} WARNING - No viable dags retrieved from /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 20:15:17,243] {processor.py:171} INFO - Processing /home/leizo/airflow/dags/lib/produce_usage.py took 13.067 seconds
[2022-06-14 20:15:56,454] {processor.py:163} INFO - Started process (PID=7722) to work on /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 20:15:56,457] {processor.py:642} INFO - Processing file /home/leizo/airflow/dags/lib/produce_usage.py for tasks to queue
[2022-06-14 20:15:56,459] {logging_mixin.py:109} INFO - [2022-06-14 20:15:56,459] {dagbag.py:500} INFO - Filling up the DagBag from /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 20:16:08,435] {logging_mixin.py:109} INFO - [DataFrame[artist: string, duration_s: bigint, name: string, rank_tag_rock: bigint], DataFrame[artist: string, duration_s: bigint, name: string, rank_tag_indie: bigint], DataFrame[artist: string, duration_s: bigint, name: string, rank_tag_alternative: bigint], DataFrame[artist: string, duration_s: bigint, name: string, rank_tag_pop: bigint]]
[2022-06-14 20:16:10,170] {logging_mixin.py:109} INFO - [DataFrame[album_name: string, album_total_tracks: bigint, artist: string, duration_ms: bigint, name: string, popularity: bigint, release_date: date, track_number: bigint], DataFrame[album_name: string, album_total_tracks: bigint, artist: string, duration_ms: bigint, name: string, popularity: bigint, release_date: date, track_number: bigint], DataFrame[album_name: string, album_total_tracks: bigint, artist: string, duration_ms: bigint, name: string, popularity: bigint, release_date: date, track_number: bigint], DataFrame[album_name: string, album_total_tracks: bigint, artist: string, duration_ms: bigint, name: string, popularity: bigint, release_date: date, track_number: bigint], DataFrame[album_name: string, album_total_tracks: bigint, artist: string, duration_ms: bigint, name: string, popularity: bigint, release_date: date, track_number: bigint], DataFrame[album_name: string, album_total_tracks: bigint, artist: string, duration_ms: bigint, name: string, popularity: bigint, release_date: date, track_number: bigint], DataFrame[album_name: string, album_total_tracks: bigint, artist: string, duration_ms: bigint, name: string, popularity: bigint, release_date: date, track_number: bigint], DataFrame[album_name: string, album_total_tracks: bigint, artist: string, duration_ms: bigint, name: string, popularity: bigint, release_date: date, track_number: bigint], DataFrame[album_name: string, album_total_tracks: bigint, artist: string, duration_ms: bigint, name: string, popularity: bigint, release_date: date, track_number: bigint], DataFrame[album_name: string, album_total_tracks: bigint, artist: string, duration_ms: bigint, name: string, popularity: bigint, release_date: date, track_number: bigint]]
[2022-06-14 20:16:10,172] {logging_mixin.py:109} INFO - [2022-06-14 20:16:10,170] {dagbag.py:334} ERROR - Failed to import: /home/leizo/airflow/dags/lib/produce_usage.py
Traceback (most recent call last):
  File "/home/leizo/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 848, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/home/leizo/airflow/dags/lib/produce_usage.py", line 62, in <module>
    DF_rock_playlists = [].toDF()
AttributeError: 'list' object has no attribute 'toDF'
[2022-06-14 20:16:10,172] {processor.py:654} WARNING - No viable dags retrieved from /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 20:16:10,195] {processor.py:171} INFO - Processing /home/leizo/airflow/dags/lib/produce_usage.py took 13.749 seconds
[2022-06-14 20:17:06,988] {processor.py:163} INFO - Started process (PID=8382) to work on /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 20:17:06,990] {processor.py:642} INFO - Processing file /home/leizo/airflow/dags/lib/produce_usage.py for tasks to queue
[2022-06-14 20:17:06,991] {logging_mixin.py:109} INFO - [2022-06-14 20:17:06,991] {dagbag.py:500} INFO - Filling up the DagBag from /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 20:17:25,022] {logging_mixin.py:109} INFO - [DataFrame[artist: string, duration_s: bigint, name: string, rank_tag_rock: bigint], DataFrame[artist: string, duration_s: bigint, name: string, rank_tag_indie: bigint], DataFrame[artist: string, duration_s: bigint, name: string, rank_tag_alternative: bigint], DataFrame[artist: string, duration_s: bigint, name: string, rank_tag_pop: bigint]]
[2022-06-14 20:17:28,203] {logging_mixin.py:109} INFO - [DataFrame[album_name: string, album_total_tracks: bigint, artist: string, duration_ms: bigint, name: string, popularity: bigint, release_date: date, track_number: bigint], DataFrame[album_name: string, album_total_tracks: bigint, artist: string, duration_ms: bigint, name: string, popularity: bigint, release_date: date, track_number: bigint], DataFrame[album_name: string, album_total_tracks: bigint, artist: string, duration_ms: bigint, name: string, popularity: bigint, release_date: date, track_number: bigint], DataFrame[album_name: string, album_total_tracks: bigint, artist: string, duration_ms: bigint, name: string, popularity: bigint, release_date: date, track_number: bigint], DataFrame[album_name: string, album_total_tracks: bigint, artist: string, duration_ms: bigint, name: string, popularity: bigint, release_date: date, track_number: bigint], DataFrame[album_name: string, album_total_tracks: bigint, artist: string, duration_ms: bigint, name: string, popularity: bigint, release_date: date, track_number: bigint], DataFrame[album_name: string, album_total_tracks: bigint, artist: string, duration_ms: bigint, name: string, popularity: bigint, release_date: date, track_number: bigint], DataFrame[album_name: string, album_total_tracks: bigint, artist: string, duration_ms: bigint, name: string, popularity: bigint, release_date: date, track_number: bigint], DataFrame[album_name: string, album_total_tracks: bigint, artist: string, duration_ms: bigint, name: string, popularity: bigint, release_date: date, track_number: bigint], DataFrame[album_name: string, album_total_tracks: bigint, artist: string, duration_ms: bigint, name: string, popularity: bigint, release_date: date, track_number: bigint]]
[2022-06-14 20:17:28,207] {logging_mixin.py:109} INFO - [2022-06-14 20:17:28,204] {dagbag.py:334} ERROR - Failed to import: /home/leizo/airflow/dags/lib/produce_usage.py
Traceback (most recent call last):
  File "/home/leizo/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 848, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/home/leizo/airflow/dags/lib/produce_usage.py", line 62, in <module>
    DF_rock_playlists = [].toDF()
AttributeError: 'list' object has no attribute 'toDF'
[2022-06-14 20:17:28,208] {processor.py:654} WARNING - No viable dags retrieved from /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 20:17:28,254] {processor.py:171} INFO - Processing /home/leizo/airflow/dags/lib/produce_usage.py took 21.274 seconds
[2022-06-14 20:18:10,038] {processor.py:163} INFO - Started process (PID=9038) to work on /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 20:18:10,041] {processor.py:642} INFO - Processing file /home/leizo/airflow/dags/lib/produce_usage.py for tasks to queue
[2022-06-14 20:18:10,042] {logging_mixin.py:109} INFO - [2022-06-14 20:18:10,042] {dagbag.py:500} INFO - Filling up the DagBag from /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 20:18:29,116] {logging_mixin.py:109} INFO - root
 |-- artist: string (nullable = true)
 |-- duration_s: long (nullable = true)
 |-- name: string (nullable = true)
 |-- rank_tag_rock: long (nullable = true)
 |-- album_name: string (nullable = true)
 |-- album_total_tracks: long (nullable = true)
 |-- artist: string (nullable = true)
 |-- duration_ms: long (nullable = true)
 |-- name: string (nullable = true)
 |-- popularity: long (nullable = true)
 |-- release_date: date (nullable = true)
 |-- track_number: long (nullable = true)
[2022-06-14 20:18:29,116] {logging_mixin.py:109} INFO - 
[2022-06-14 20:18:29,117] {processor.py:654} WARNING - No viable dags retrieved from /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 20:18:29,134] {processor.py:171} INFO - Processing /home/leizo/airflow/dags/lib/produce_usage.py took 19.101 seconds
[2022-06-14 20:19:34,362] {processor.py:163} INFO - Started process (PID=10525) to work on /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 20:19:34,365] {processor.py:642} INFO - Processing file /home/leizo/airflow/dags/lib/produce_usage.py for tasks to queue
[2022-06-14 20:19:34,365] {logging_mixin.py:109} INFO - [2022-06-14 20:19:34,365] {dagbag.py:500} INFO - Filling up the DagBag from /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 20:19:48,943] {logging_mixin.py:109} INFO - root
 |-- artist: string (nullable = true)
 |-- duration_s: long (nullable = true)
 |-- name: string (nullable = true)
 |-- rank_tag_rock: long (nullable = true)
 |-- album_name: string (nullable = true)
 |-- album_total_tracks: long (nullable = true)
 |-- artist: string (nullable = true)
 |-- duration_ms: long (nullable = true)
 |-- name: string (nullable = true)
 |-- popularity: long (nullable = true)
 |-- release_date: date (nullable = true)
 |-- track_number: long (nullable = true)
[2022-06-14 20:19:48,943] {logging_mixin.py:109} INFO - 
[2022-06-14 20:19:54,877] {processor.py:654} WARNING - No viable dags retrieved from /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 20:19:54,895] {processor.py:171} INFO - Processing /home/leizo/airflow/dags/lib/produce_usage.py took 20.537 seconds
[2022-06-14 20:20:34,777] {processor.py:163} INFO - Started process (PID=11255) to work on /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 20:20:34,780] {processor.py:642} INFO - Processing file /home/leizo/airflow/dags/lib/produce_usage.py for tasks to queue
[2022-06-14 20:20:34,781] {logging_mixin.py:109} INFO - [2022-06-14 20:20:34,781] {dagbag.py:500} INFO - Filling up the DagBag from /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 20:20:49,984] {logging_mixin.py:109} INFO - root
 |-- artist: string (nullable = true)
 |-- duration_s: long (nullable = true)
 |-- name: string (nullable = true)
 |-- rank_tag_rock: long (nullable = true)
 |-- album_name: string (nullable = true)
 |-- album_total_tracks: long (nullable = true)
 |-- artist: string (nullable = true)
 |-- duration_ms: long (nullable = true)
 |-- name: string (nullable = true)
 |-- popularity: long (nullable = true)
 |-- release_date: date (nullable = true)
 |-- track_number: long (nullable = true)
[2022-06-14 20:20:49,984] {logging_mixin.py:109} INFO - 
[2022-06-14 20:20:56,182] {processor.py:654} WARNING - No viable dags retrieved from /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 20:20:56,200] {processor.py:171} INFO - Processing /home/leizo/airflow/dags/lib/produce_usage.py took 21.426 seconds
[2022-06-14 20:21:50,851] {processor.py:163} INFO - Started process (PID=12011) to work on /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 20:21:50,854] {processor.py:642} INFO - Processing file /home/leizo/airflow/dags/lib/produce_usage.py for tasks to queue
[2022-06-14 20:21:50,854] {logging_mixin.py:109} INFO - [2022-06-14 20:21:50,854] {dagbag.py:500} INFO - Filling up the DagBag from /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 20:22:05,433] {logging_mixin.py:109} INFO - root
 |-- artist: string (nullable = true)
 |-- duration_s: long (nullable = true)
 |-- name: string (nullable = true)
 |-- rank_tag_rock: long (nullable = true)
 |-- album_name: string (nullable = true)
 |-- album_total_tracks: long (nullable = true)
 |-- artist: string (nullable = true)
 |-- duration_ms: long (nullable = true)
 |-- name: string (nullable = true)
 |-- popularity: long (nullable = true)
 |-- release_date: date (nullable = true)
 |-- track_number: long (nullable = true)
[2022-06-14 20:22:05,434] {logging_mixin.py:109} INFO - 
[2022-06-14 20:22:11,274] {processor.py:654} WARNING - No viable dags retrieved from /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 20:22:11,291] {processor.py:171} INFO - Processing /home/leizo/airflow/dags/lib/produce_usage.py took 20.443 seconds
[2022-06-14 20:22:52,590] {processor.py:163} INFO - Started process (PID=12739) to work on /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 20:22:52,592] {processor.py:642} INFO - Processing file /home/leizo/airflow/dags/lib/produce_usage.py for tasks to queue
[2022-06-14 20:22:52,593] {logging_mixin.py:109} INFO - [2022-06-14 20:22:52,593] {dagbag.py:500} INFO - Filling up the DagBag from /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 20:23:08,663] {logging_mixin.py:109} INFO - root
 |-- artist: string (nullable = true)
 |-- duration_s: long (nullable = true)
 |-- name: string (nullable = true)
 |-- rank_tag_rock: long (nullable = true)
 |-- album_name: string (nullable = true)
 |-- album_total_tracks: long (nullable = true)
 |-- artist: string (nullable = true)
 |-- duration_ms: long (nullable = true)
 |-- name: string (nullable = true)
 |-- popularity: long (nullable = true)
 |-- release_date: date (nullable = true)
 |-- track_number: long (nullable = true)
[2022-06-14 20:23:08,664] {logging_mixin.py:109} INFO - 
[2022-06-14 20:23:16,197] {processor.py:654} WARNING - No viable dags retrieved from /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 20:23:16,228] {processor.py:171} INFO - Processing /home/leizo/airflow/dags/lib/produce_usage.py took 23.640 seconds
[2022-06-14 20:24:12,352] {processor.py:163} INFO - Started process (PID=13496) to work on /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 20:24:12,354] {processor.py:642} INFO - Processing file /home/leizo/airflow/dags/lib/produce_usage.py for tasks to queue
[2022-06-14 20:24:12,354] {logging_mixin.py:109} INFO - [2022-06-14 20:24:12,354] {dagbag.py:500} INFO - Filling up the DagBag from /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 20:24:27,364] {logging_mixin.py:109} INFO - root
 |-- artist: string (nullable = true)
 |-- duration_s: long (nullable = true)
 |-- name: string (nullable = true)
 |-- rank_tag_rock: long (nullable = true)
 |-- album_name: string (nullable = true)
 |-- album_total_tracks: long (nullable = true)
 |-- artist: string (nullable = true)
 |-- duration_ms: long (nullable = true)
 |-- name: string (nullable = true)
 |-- popularity: long (nullable = true)
 |-- release_date: date (nullable = true)
 |-- track_number: long (nullable = true)
[2022-06-14 20:24:27,365] {logging_mixin.py:109} INFO - 
[2022-06-14 20:24:34,183] {processor.py:654} WARNING - No viable dags retrieved from /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 20:24:34,205] {processor.py:171} INFO - Processing /home/leizo/airflow/dags/lib/produce_usage.py took 21.856 seconds
[2022-06-14 20:25:19,190] {processor.py:163} INFO - Started process (PID=14611) to work on /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 20:25:19,193] {processor.py:642} INFO - Processing file /home/leizo/airflow/dags/lib/produce_usage.py for tasks to queue
[2022-06-14 20:25:19,194] {logging_mixin.py:109} INFO - [2022-06-14 20:25:19,193] {dagbag.py:500} INFO - Filling up the DagBag from /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 20:25:34,781] {logging_mixin.py:109} INFO - [2022-06-14 20:25:34,780] {dagbag.py:334} ERROR - Failed to import: /home/leizo/airflow/dags/lib/produce_usage.py
Traceback (most recent call last):
  File "/home/leizo/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 848, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/home/leizo/airflow/dags/lib/produce_usage.py", line 70, in <module>
    df_joined_by_tag()
TypeError: df_joined_by_tag() missing 2 required positional arguments: 'list_spotify_playlists' and 'lastfm_tracks'
[2022-06-14 20:25:34,782] {processor.py:654} WARNING - No viable dags retrieved from /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 20:25:34,811] {processor.py:171} INFO - Processing /home/leizo/airflow/dags/lib/produce_usage.py took 15.623 seconds
[2022-06-14 20:26:38,255] {processor.py:163} INFO - Started process (PID=15672) to work on /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 20:26:38,258] {processor.py:642} INFO - Processing file /home/leizo/airflow/dags/lib/produce_usage.py for tasks to queue
[2022-06-14 20:26:38,259] {logging_mixin.py:109} INFO - [2022-06-14 20:26:38,259] {dagbag.py:500} INFO - Filling up the DagBag from /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 20:27:00,473] {processor.py:654} WARNING - No viable dags retrieved from /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 20:27:00,501] {processor.py:171} INFO - Processing /home/leizo/airflow/dags/lib/produce_usage.py took 22.248 seconds
[2022-06-14 20:27:43,104] {processor.py:163} INFO - Started process (PID=16725) to work on /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 20:27:43,107] {processor.py:642} INFO - Processing file /home/leizo/airflow/dags/lib/produce_usage.py for tasks to queue
[2022-06-14 20:27:43,108] {logging_mixin.py:109} INFO - [2022-06-14 20:27:43,108] {dagbag.py:500} INFO - Filling up the DagBag from /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 20:28:02,216] {logging_mixin.py:109} INFO - 6
[2022-06-14 20:28:02,216] {processor.py:654} WARNING - No viable dags retrieved from /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 20:28:02,228] {processor.py:171} INFO - Processing /home/leizo/airflow/dags/lib/produce_usage.py took 19.127 seconds
[2022-06-14 20:29:14,378] {processor.py:163} INFO - Started process (PID=18312) to work on /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 20:29:14,380] {processor.py:642} INFO - Processing file /home/leizo/airflow/dags/lib/produce_usage.py for tasks to queue
[2022-06-14 20:29:14,381] {logging_mixin.py:109} INFO - [2022-06-14 20:29:14,381] {dagbag.py:500} INFO - Filling up the DagBag from /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 20:29:36,645] {logging_mixin.py:109} INFO - 36
[2022-06-14 20:29:36,646] {processor.py:654} WARNING - No viable dags retrieved from /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 20:29:36,670] {processor.py:171} INFO - Processing /home/leizo/airflow/dags/lib/produce_usage.py took 22.294 seconds
[2022-06-14 20:30:17,720] {processor.py:163} INFO - Started process (PID=19046) to work on /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 20:30:17,724] {processor.py:642} INFO - Processing file /home/leizo/airflow/dags/lib/produce_usage.py for tasks to queue
[2022-06-14 20:30:17,725] {logging_mixin.py:109} INFO - [2022-06-14 20:30:17,724] {dagbag.py:500} INFO - Filling up the DagBag from /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 20:30:40,219] {logging_mixin.py:109} INFO - 36
[2022-06-14 20:30:40,220] {processor.py:654} WARNING - No viable dags retrieved from /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 20:30:40,240] {processor.py:171} INFO - Processing /home/leizo/airflow/dags/lib/produce_usage.py took 22.522 seconds
[2022-06-14 20:31:35,978] {processor.py:163} INFO - Started process (PID=19811) to work on /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 20:31:35,981] {processor.py:642} INFO - Processing file /home/leizo/airflow/dags/lib/produce_usage.py for tasks to queue
[2022-06-14 20:31:35,982] {logging_mixin.py:109} INFO - [2022-06-14 20:31:35,981] {dagbag.py:500} INFO - Filling up the DagBag from /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 20:31:58,250] {logging_mixin.py:109} INFO - 36
[2022-06-14 20:31:58,251] {processor.py:654} WARNING - No viable dags retrieved from /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 20:31:58,281] {processor.py:171} INFO - Processing /home/leizo/airflow/dags/lib/produce_usage.py took 22.307 seconds
[2022-06-14 20:32:41,508] {processor.py:163} INFO - Started process (PID=20548) to work on /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 20:32:41,512] {processor.py:642} INFO - Processing file /home/leizo/airflow/dags/lib/produce_usage.py for tasks to queue
[2022-06-14 20:32:41,514] {logging_mixin.py:109} INFO - [2022-06-14 20:32:41,514] {dagbag.py:500} INFO - Filling up the DagBag from /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 20:33:05,561] {logging_mixin.py:109} INFO - 36
[2022-06-14 20:33:05,562] {processor.py:654} WARNING - No viable dags retrieved from /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 20:33:05,581] {processor.py:171} INFO - Processing /home/leizo/airflow/dags/lib/produce_usage.py took 24.079 seconds
[2022-06-14 20:34:06,155] {processor.py:163} INFO - Started process (PID=21310) to work on /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 20:34:06,159] {processor.py:642} INFO - Processing file /home/leizo/airflow/dags/lib/produce_usage.py for tasks to queue
[2022-06-14 20:34:06,160] {logging_mixin.py:109} INFO - [2022-06-14 20:34:06,160] {dagbag.py:500} INFO - Filling up the DagBag from /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 20:34:29,558] {logging_mixin.py:109} INFO - 36
[2022-06-14 20:34:29,559] {processor.py:654} WARNING - No viable dags retrieved from /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 20:34:29,573] {processor.py:171} INFO - Processing /home/leizo/airflow/dags/lib/produce_usage.py took 23.423 seconds
[2022-06-14 20:35:12,886] {processor.py:163} INFO - Started process (PID=22061) to work on /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 20:35:12,888] {processor.py:642} INFO - Processing file /home/leizo/airflow/dags/lib/produce_usage.py for tasks to queue
[2022-06-14 20:35:12,889] {logging_mixin.py:109} INFO - [2022-06-14 20:35:12,889] {dagbag.py:500} INFO - Filling up the DagBag from /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 20:35:31,275] {processor.py:654} WARNING - No viable dags retrieved from /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 20:35:31,296] {processor.py:171} INFO - Processing /home/leizo/airflow/dags/lib/produce_usage.py took 18.412 seconds
[2022-06-14 20:36:29,757] {processor.py:163} INFO - Started process (PID=22779) to work on /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 20:36:29,760] {processor.py:642} INFO - Processing file /home/leizo/airflow/dags/lib/produce_usage.py for tasks to queue
[2022-06-14 20:36:29,761] {logging_mixin.py:109} INFO - [2022-06-14 20:36:29,761] {dagbag.py:500} INFO - Filling up the DagBag from /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 20:36:49,386] {processor.py:654} WARNING - No viable dags retrieved from /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 20:36:49,406] {processor.py:171} INFO - Processing /home/leizo/airflow/dags/lib/produce_usage.py took 19.653 seconds
[2022-06-14 20:37:33,092] {processor.py:163} INFO - Started process (PID=23461) to work on /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 20:37:33,096] {processor.py:642} INFO - Processing file /home/leizo/airflow/dags/lib/produce_usage.py for tasks to queue
[2022-06-14 20:37:33,097] {logging_mixin.py:109} INFO - [2022-06-14 20:37:33,097] {dagbag.py:500} INFO - Filling up the DagBag from /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 20:37:56,117] {processor.py:654} WARNING - No viable dags retrieved from /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 20:37:56,145] {processor.py:171} INFO - Processing /home/leizo/airflow/dags/lib/produce_usage.py took 23.059 seconds
[2022-06-14 20:38:58,075] {processor.py:163} INFO - Started process (PID=24169) to work on /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 20:38:58,077] {processor.py:642} INFO - Processing file /home/leizo/airflow/dags/lib/produce_usage.py for tasks to queue
[2022-06-14 20:38:58,078] {logging_mixin.py:109} INFO - [2022-06-14 20:38:58,078] {dagbag.py:500} INFO - Filling up the DagBag from /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 20:39:15,366] {processor.py:654} WARNING - No viable dags retrieved from /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 20:39:15,385] {processor.py:171} INFO - Processing /home/leizo/airflow/dags/lib/produce_usage.py took 17.312 seconds
[2022-06-14 20:40:01,796] {processor.py:163} INFO - Started process (PID=25256) to work on /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 20:40:01,799] {processor.py:642} INFO - Processing file /home/leizo/airflow/dags/lib/produce_usage.py for tasks to queue
[2022-06-14 20:40:01,800] {logging_mixin.py:109} INFO - [2022-06-14 20:40:01,800] {dagbag.py:500} INFO - Filling up the DagBag from /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 20:40:20,181] {logging_mixin.py:109} INFO - [2022-06-14 20:40:20,178] {dagbag.py:334} ERROR - Failed to import: /home/leizo/airflow/dags/lib/produce_usage.py
Traceback (most recent call last):
  File "/home/leizo/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 848, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/home/leizo/airflow/dags/lib/produce_usage.py", line 67, in <module>
    df_joined_by_tag(list_spotify_playlists, list_lastfm_tracks[0])
  File "/home/leizo/airflow/dags/lib/produce_usage.py", line 58, in df_joined_by_tag
    TARGET_PATH = HOME + "/datalake/usage/recommendation/bytracks/" + lastfm_tracks + "/usage.parquet"
TypeError: can only concatenate str (not "DataFrame") to str
[2022-06-14 20:40:20,182] {processor.py:654} WARNING - No viable dags retrieved from /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 20:40:20,210] {processor.py:171} INFO - Processing /home/leizo/airflow/dags/lib/produce_usage.py took 18.418 seconds
[2022-06-14 20:41:31,094] {processor.py:163} INFO - Started process (PID=26609) to work on /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 20:41:31,098] {processor.py:642} INFO - Processing file /home/leizo/airflow/dags/lib/produce_usage.py for tasks to queue
[2022-06-14 20:41:31,100] {logging_mixin.py:109} INFO - [2022-06-14 20:41:31,099] {dagbag.py:500} INFO - Filling up the DagBag from /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 20:41:55,781] {logging_mixin.py:109} INFO - paquet already exists rock 20220614
[2022-06-14 20:41:55,783] {processor.py:654} WARNING - No viable dags retrieved from /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 20:41:55,802] {processor.py:171} INFO - Processing /home/leizo/airflow/dags/lib/produce_usage.py took 24.713 seconds
[2022-06-14 20:42:39,297] {processor.py:163} INFO - Started process (PID=27543) to work on /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 20:42:39,300] {processor.py:642} INFO - Processing file /home/leizo/airflow/dags/lib/produce_usage.py for tasks to queue
[2022-06-14 20:42:39,301] {logging_mixin.py:109} INFO - [2022-06-14 20:42:39,300] {dagbag.py:500} INFO - Filling up the DagBag from /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 20:42:39,303] {logging_mixin.py:109} INFO - [2022-06-14 20:42:39,302] {dagbag.py:334} ERROR - Failed to import: /home/leizo/airflow/dags/lib/produce_usage.py
Traceback (most recent call last):
  File "/home/leizo/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 844, in exec_module
  File "<frozen importlib._bootstrap_external>", line 981, in get_code
  File "<frozen importlib._bootstrap_external>", line 911, in source_to_code
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/home/leizo/airflow/dags/lib/produce_usage.py", line 60
    DF_tag_playlists.write.parquet(TARGET_PATH)
    ^
IndentationError: unexpected indent
[2022-06-14 20:42:39,303] {processor.py:654} WARNING - No viable dags retrieved from /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 20:42:39,322] {processor.py:171} INFO - Processing /home/leizo/airflow/dags/lib/produce_usage.py took 0.027 seconds
[2022-06-14 20:43:50,235] {processor.py:163} INFO - Started process (PID=28550) to work on /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 20:43:50,238] {processor.py:642} INFO - Processing file /home/leizo/airflow/dags/lib/produce_usage.py for tasks to queue
[2022-06-14 20:43:50,239] {logging_mixin.py:109} INFO - [2022-06-14 20:43:50,239] {dagbag.py:500} INFO - Filling up the DagBag from /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 20:44:14,536] {logging_mixin.py:109} INFO - [2022-06-14 20:44:14,522] {dagbag.py:334} ERROR - Failed to import: /home/leizo/airflow/dags/lib/produce_usage.py
Traceback (most recent call last):
  File "/home/leizo/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 848, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/home/leizo/airflow/dags/lib/produce_usage.py", line 65, in <module>
    df_joined_by_tag(list_spotify_playlists, list_lastfm_tracks[0])
  File "/home/leizo/airflow/dags/lib/produce_usage.py", line 61, in df_joined_by_tag
    DF_tag_playlists.write.parquet(TARGET_PATH)
  File "/home/leizo/.local/lib/python3.8/site-packages/pyspark/sql/readwriter.py", line 885, in parquet
    self._jwrite.parquet(path)
  File "/home/leizo/.local/lib/python3.8/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/home/leizo/.local/lib/python3.8/site-packages/pyspark/sql/utils.py", line 117, in deco
    raise converted from None
pyspark.sql.utils.AnalysisException: Found duplicate column(s) when inserting into file:/home/leizo/datalake/usage/recommendation/bytracks/rock/usage.parquet: `artist`, `name`
[2022-06-14 20:44:14,544] {processor.py:654} WARNING - No viable dags retrieved from /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 20:44:14,578] {processor.py:171} INFO - Processing /home/leizo/airflow/dags/lib/produce_usage.py took 24.346 seconds
[2022-06-14 20:44:57,898] {processor.py:163} INFO - Started process (PID=29505) to work on /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 20:44:57,901] {processor.py:642} INFO - Processing file /home/leizo/airflow/dags/lib/produce_usage.py for tasks to queue
[2022-06-14 20:44:57,901] {logging_mixin.py:109} INFO - [2022-06-14 20:44:57,901] {dagbag.py:500} INFO - Filling up the DagBag from /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 20:45:18,615] {logging_mixin.py:109} INFO - [2022-06-14 20:45:18,604] {dagbag.py:334} ERROR - Failed to import: /home/leizo/airflow/dags/lib/produce_usage.py
Traceback (most recent call last):
  File "/home/leizo/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 848, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/home/leizo/airflow/dags/lib/produce_usage.py", line 65, in <module>
    df_joined_by_tag(list_spotify_playlists, list_lastfm_tracks[0])
  File "/home/leizo/airflow/dags/lib/produce_usage.py", line 61, in df_joined_by_tag
    DF_tag_playlists.write.parquet(TARGET_PATH)
  File "/home/leizo/.local/lib/python3.8/site-packages/pyspark/sql/readwriter.py", line 885, in parquet
    self._jwrite.parquet(path)
  File "/home/leizo/.local/lib/python3.8/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/home/leizo/.local/lib/python3.8/site-packages/pyspark/sql/utils.py", line 117, in deco
    raise converted from None
pyspark.sql.utils.AnalysisException: Found duplicate column(s) when inserting into file:/home/leizo/datalake/usage/recommendation/bytracks/rock/usage.parquet: `artist`, `name`
[2022-06-14 20:45:18,622] {processor.py:654} WARNING - No viable dags retrieved from /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 20:45:18,647] {processor.py:171} INFO - Processing /home/leizo/airflow/dags/lib/produce_usage.py took 20.751 seconds
[2022-06-14 20:46:07,945] {processor.py:163} INFO - Started process (PID=30464) to work on /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 20:46:07,949] {processor.py:642} INFO - Processing file /home/leizo/airflow/dags/lib/produce_usage.py for tasks to queue
[2022-06-14 20:46:07,951] {logging_mixin.py:109} INFO - [2022-06-14 20:46:07,951] {dagbag.py:500} INFO - Filling up the DagBag from /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 20:46:25,995] {logging_mixin.py:109} INFO - [2022-06-14 20:46:25,979] {dagbag.py:334} ERROR - Failed to import: /home/leizo/airflow/dags/lib/produce_usage.py
Traceback (most recent call last):
  File "/home/leizo/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 848, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/home/leizo/airflow/dags/lib/produce_usage.py", line 67, in <module>
    df_joined_by_tag(list_spotify_playlists, list_lastfm_tracks[0])
  File "/home/leizo/airflow/dags/lib/produce_usage.py", line 56, in df_joined_by_tag
    DF_tag_playlists = DF_tag_playlists.union(df_join) \
  File "/home/leizo/.local/lib/python3.8/site-packages/pyspark/sql/dataframe.py", line 1844, in union
    return DataFrame(self._jdf.union(other._jdf), self.sql_ctx)
  File "/home/leizo/.local/lib/python3.8/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/home/leizo/.local/lib/python3.8/site-packages/pyspark/sql/utils.py", line 117, in deco
    raise converted from None
pyspark.sql.utils.AnalysisException: Union can only be performed on tables with the same number of columns, but the first table has 11 columns and the second table has 12 columns;
'Union false, false
:- Project [artist#0, name#2, rank_tag_rock#3L, album_name#48, album_total_tracks#49L, artist#50, duration_ms#51L, name#52, popularity#53L, release_date#54, track_number#55L]
:  +- Deduplicate [popularity#53L, name#2, name#52, duration_ms#51L, album_total_tracks#49L, album_name#48, release_date#54, artist#0, artist#50, track_number#55L, duration_s#1L, rank_tag_rock#3L]
:     +- Union false, false
:        :- Join Inner, (name#2 = name#52)
:        :  :- Relation [artist#0,duration_s#1L,name#2,rank_tag_rock#3L] parquet
:        :  +- Relation [album_name#48,album_total_tracks#49L,artist#50,duration_ms#51L,name#52,popularity#53L,release_date#54,track_number#55L] parquet
:        +- Join Inner, (name#258 = name#68)
:           :- Relation [artist#256,duration_s#257L,name#258,rank_tag_rock#259L] parquet
:           +- Relation [album_name#64,album_total_tracks#65L,artist#66,duration_ms#67L,name#68,popularity#69L,release_date#70,track_number#71L] parquet
+- Join Inner, (name#309 = name#84)
   :- Relation [artist#307,duration_s#308L,name#309,rank_tag_rock#310L] parquet
   +- Relation [album_name#80,album_total_tracks#81L,artist#82,duration_ms#83L,name#84,popularity#85L,release_date#86,track_number#87L] parquet
[2022-06-14 20:46:26,008] {processor.py:654} WARNING - No viable dags retrieved from /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 20:46:26,030] {processor.py:171} INFO - Processing /home/leizo/airflow/dags/lib/produce_usage.py took 18.091 seconds
[2022-06-14 20:47:08,252] {processor.py:163} INFO - Started process (PID=31545) to work on /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 20:47:08,254] {processor.py:642} INFO - Processing file /home/leizo/airflow/dags/lib/produce_usage.py for tasks to queue
[2022-06-14 20:47:08,255] {logging_mixin.py:109} INFO - [2022-06-14 20:47:08,255] {dagbag.py:500} INFO - Filling up the DagBag from /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 20:47:25,952] {logging_mixin.py:109} INFO - [2022-06-14 20:47:25,941] {dagbag.py:334} ERROR - Failed to import: /home/leizo/airflow/dags/lib/produce_usage.py
Traceback (most recent call last):
  File "/home/leizo/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 848, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/home/leizo/airflow/dags/lib/produce_usage.py", line 68, in <module>
    df_joined_by_tag(list_spotify_playlists, list_lastfm_tracks[0])
  File "/home/leizo/airflow/dags/lib/produce_usage.py", line 64, in df_joined_by_tag
    DF_tag_playlists.write.parquet(TARGET_PATH)
  File "/home/leizo/.local/lib/python3.8/site-packages/pyspark/sql/readwriter.py", line 885, in parquet
    self._jwrite.parquet(path)
  File "/home/leizo/.local/lib/python3.8/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/home/leizo/.local/lib/python3.8/site-packages/pyspark/sql/utils.py", line 117, in deco
    raise converted from None
pyspark.sql.utils.AnalysisException: Found duplicate column(s) when inserting into file:/home/leizo/datalake/usage/recommendation/bytracks/rock/usage.parquet: `artist`, `name`
[2022-06-14 20:47:25,963] {processor.py:654} WARNING - No viable dags retrieved from /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 20:47:25,985] {processor.py:171} INFO - Processing /home/leizo/airflow/dags/lib/produce_usage.py took 17.740 seconds
[2022-06-14 20:48:07,720] {processor.py:163} INFO - Started process (PID=32085) to work on /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 20:48:07,724] {processor.py:642} INFO - Processing file /home/leizo/airflow/dags/lib/produce_usage.py for tasks to queue
[2022-06-14 20:48:07,727] {logging_mixin.py:109} INFO - [2022-06-14 20:48:07,727] {dagbag.py:500} INFO - Filling up the DagBag from /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 20:48:24,337] {logging_mixin.py:109} INFO - [2022-06-14 20:48:24,325] {dagbag.py:334} ERROR - Failed to import: /home/leizo/airflow/dags/lib/produce_usage.py
Traceback (most recent call last):
  File "/home/leizo/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 848, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/home/leizo/airflow/dags/lib/produce_usage.py", line 68, in <module>
    df_joined_by_tag(list_spotify_playlists, list_lastfm_tracks[0])
  File "/home/leizo/airflow/dags/lib/produce_usage.py", line 64, in df_joined_by_tag
    DF_tag_playlists.write.parquet(TARGET_PATH)
  File "/home/leizo/.local/lib/python3.8/site-packages/pyspark/sql/readwriter.py", line 885, in parquet
    self._jwrite.parquet(path)
  File "/home/leizo/.local/lib/python3.8/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/home/leizo/.local/lib/python3.8/site-packages/pyspark/sql/utils.py", line 117, in deco
    raise converted from None
pyspark.sql.utils.AnalysisException: Found duplicate column(s) when inserting into file:/home/leizo/datalake/usage/recommendation/bytracks/rock/usage.parquet: `artist`, `name`
[2022-06-14 20:48:24,343] {processor.py:654} WARNING - No viable dags retrieved from /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 20:48:24,361] {processor.py:171} INFO - Processing /home/leizo/airflow/dags/lib/produce_usage.py took 16.647 seconds
[2022-06-14 20:49:00,204] {processor.py:163} INFO - Started process (PID=32763) to work on /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 20:49:00,206] {processor.py:642} INFO - Processing file /home/leizo/airflow/dags/lib/produce_usage.py for tasks to queue
[2022-06-14 20:49:00,206] {logging_mixin.py:109} INFO - [2022-06-14 20:49:00,206] {dagbag.py:500} INFO - Filling up the DagBag from /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 20:49:13,540] {logging_mixin.py:109} INFO - [2022-06-14 20:49:13,525] {dagbag.py:334} ERROR - Failed to import: /home/leizo/airflow/dags/lib/produce_usage.py
Traceback (most recent call last):
  File "/home/leizo/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 848, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/home/leizo/airflow/dags/lib/produce_usage.py", line 68, in <module>
    df_joined_by_tag(list_spotify_playlists, list_lastfm_tracks[0])
  File "/home/leizo/airflow/dags/lib/produce_usage.py", line 64, in df_joined_by_tag
    DF_tag_playlists.write.parquet(TARGET_PATH)
  File "/home/leizo/.local/lib/python3.8/site-packages/pyspark/sql/readwriter.py", line 885, in parquet
    self._jwrite.parquet(path)
  File "/home/leizo/.local/lib/python3.8/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/home/leizo/.local/lib/python3.8/site-packages/pyspark/sql/utils.py", line 117, in deco
    raise converted from None
pyspark.sql.utils.AnalysisException: Found duplicate column(s) when inserting into file:/home/leizo/datalake/usage/recommendation/bytracks/rock/usage.parquet: `artist`, `name`
[2022-06-14 20:49:13,552] {processor.py:654} WARNING - No viable dags retrieved from /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 20:49:13,589] {processor.py:171} INFO - Processing /home/leizo/airflow/dags/lib/produce_usage.py took 13.388 seconds
[2022-06-14 20:49:53,966] {processor.py:163} INFO - Started process (PID=835) to work on /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 20:49:53,969] {processor.py:642} INFO - Processing file /home/leizo/airflow/dags/lib/produce_usage.py for tasks to queue
[2022-06-14 20:49:53,970] {logging_mixin.py:109} INFO - [2022-06-14 20:49:53,970] {dagbag.py:500} INFO - Filling up the DagBag from /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 20:50:07,187] {logging_mixin.py:109} INFO - [2022-06-14 20:50:07,178] {dagbag.py:334} ERROR - Failed to import: /home/leizo/airflow/dags/lib/produce_usage.py
Traceback (most recent call last):
  File "/home/leizo/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 848, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/home/leizo/airflow/dags/lib/produce_usage.py", line 68, in <module>
    df_joined_by_tag(list_spotify_playlists, list_lastfm_tracks[0])
  File "/home/leizo/airflow/dags/lib/produce_usage.py", line 64, in df_joined_by_tag
    DF_tag_playlists.write.parquet(TARGET_PATH)
  File "/home/leizo/.local/lib/python3.8/site-packages/pyspark/sql/readwriter.py", line 885, in parquet
    self._jwrite.parquet(path)
  File "/home/leizo/.local/lib/python3.8/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/home/leizo/.local/lib/python3.8/site-packages/pyspark/sql/utils.py", line 117, in deco
    raise converted from None
pyspark.sql.utils.AnalysisException: Found duplicate column(s) when inserting into file:/home/leizo/datalake/usage/recommendation/bytracks/rock/usage.parquet: `artist`, `name`
[2022-06-14 20:50:07,193] {processor.py:654} WARNING - No viable dags retrieved from /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 20:50:07,210] {processor.py:171} INFO - Processing /home/leizo/airflow/dags/lib/produce_usage.py took 13.246 seconds
[2022-06-14 20:50:41,860] {processor.py:163} INFO - Started process (PID=1512) to work on /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 20:50:41,862] {processor.py:642} INFO - Processing file /home/leizo/airflow/dags/lib/produce_usage.py for tasks to queue
[2022-06-14 20:50:41,862] {logging_mixin.py:109} INFO - [2022-06-14 20:50:41,862] {dagbag.py:500} INFO - Filling up the DagBag from /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 20:50:54,616] {logging_mixin.py:109} INFO - [2022-06-14 20:50:54,607] {dagbag.py:334} ERROR - Failed to import: /home/leizo/airflow/dags/lib/produce_usage.py
Traceback (most recent call last):
  File "/home/leizo/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 848, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/home/leizo/airflow/dags/lib/produce_usage.py", line 68, in <module>
    df_joined_by_tag(list_spotify_playlists, list_lastfm_tracks[0])
  File "/home/leizo/airflow/dags/lib/produce_usage.py", line 64, in df_joined_by_tag
    DF_tag_playlists.write.parquet(TARGET_PATH)
  File "/home/leizo/.local/lib/python3.8/site-packages/pyspark/sql/readwriter.py", line 885, in parquet
    self._jwrite.parquet(path)
  File "/home/leizo/.local/lib/python3.8/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/home/leizo/.local/lib/python3.8/site-packages/pyspark/sql/utils.py", line 117, in deco
    raise converted from None
pyspark.sql.utils.AnalysisException: Found duplicate column(s) when inserting into file:/home/leizo/datalake/usage/recommendation/bytracks/rock/usage.parquet: `artist`, `name`
[2022-06-14 20:50:54,620] {processor.py:654} WARNING - No viable dags retrieved from /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 20:50:54,635] {processor.py:171} INFO - Processing /home/leizo/airflow/dags/lib/produce_usage.py took 12.778 seconds
[2022-06-14 20:51:32,731] {processor.py:163} INFO - Started process (PID=2036) to work on /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 20:51:32,733] {processor.py:642} INFO - Processing file /home/leizo/airflow/dags/lib/produce_usage.py for tasks to queue
[2022-06-14 20:51:32,734] {logging_mixin.py:109} INFO - [2022-06-14 20:51:32,734] {dagbag.py:500} INFO - Filling up the DagBag from /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 20:51:50,615] {logging_mixin.py:109} INFO - [2022-06-14 20:51:50,601] {dagbag.py:334} ERROR - Failed to import: /home/leizo/airflow/dags/lib/produce_usage.py
Traceback (most recent call last):
  File "/home/leizo/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 848, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/home/leizo/airflow/dags/lib/produce_usage.py", line 68, in <module>
    df_joined_by_tag(list_spotify_playlists, list_lastfm_tracks[0])
  File "/home/leizo/airflow/dags/lib/produce_usage.py", line 64, in df_joined_by_tag
    DF_tag_playlists.write.parquet(TARGET_PATH)
  File "/home/leizo/.local/lib/python3.8/site-packages/pyspark/sql/readwriter.py", line 885, in parquet
    self._jwrite.parquet(path)
  File "/home/leizo/.local/lib/python3.8/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/home/leizo/.local/lib/python3.8/site-packages/pyspark/sql/utils.py", line 117, in deco
    raise converted from None
pyspark.sql.utils.AnalysisException: Found duplicate column(s) when inserting into file:/home/leizo/datalake/usage/recommendation/bytracks/rock/usage.parquet: `artist`, `name`
[2022-06-14 20:51:50,626] {processor.py:654} WARNING - No viable dags retrieved from /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 20:51:50,663] {processor.py:171} INFO - Processing /home/leizo/airflow/dags/lib/produce_usage.py took 17.934 seconds
[2022-06-14 20:52:35,154] {processor.py:163} INFO - Started process (PID=2729) to work on /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 20:52:35,157] {processor.py:642} INFO - Processing file /home/leizo/airflow/dags/lib/produce_usage.py for tasks to queue
[2022-06-14 20:52:35,158] {logging_mixin.py:109} INFO - [2022-06-14 20:52:35,158] {dagbag.py:500} INFO - Filling up the DagBag from /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 20:52:51,758] {logging_mixin.py:109} INFO - [2022-06-14 20:52:51,748] {dagbag.py:334} ERROR - Failed to import: /home/leizo/airflow/dags/lib/produce_usage.py
Traceback (most recent call last):
  File "/home/leizo/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 848, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/home/leizo/airflow/dags/lib/produce_usage.py", line 68, in <module>
    df_joined_by_tag(list_spotify_playlists, list_lastfm_tracks[0])
  File "/home/leizo/airflow/dags/lib/produce_usage.py", line 64, in df_joined_by_tag
    DF_tag_playlists.write.parquet(TARGET_PATH)
  File "/home/leizo/.local/lib/python3.8/site-packages/pyspark/sql/readwriter.py", line 885, in parquet
    self._jwrite.parquet(path)
  File "/home/leizo/.local/lib/python3.8/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/home/leizo/.local/lib/python3.8/site-packages/pyspark/sql/utils.py", line 117, in deco
    raise converted from None
pyspark.sql.utils.AnalysisException: Found duplicate column(s) when inserting into file:/home/leizo/datalake/usage/recommendation/bytracks/rock/usage.parquet: `artist`, `name`
[2022-06-14 20:52:51,764] {processor.py:654} WARNING - No viable dags retrieved from /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 20:52:51,782] {processor.py:171} INFO - Processing /home/leizo/airflow/dags/lib/produce_usage.py took 16.636 seconds
[2022-06-14 20:53:33,784] {processor.py:163} INFO - Started process (PID=3263) to work on /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 20:53:33,786] {processor.py:642} INFO - Processing file /home/leizo/airflow/dags/lib/produce_usage.py for tasks to queue
[2022-06-14 20:53:33,787] {logging_mixin.py:109} INFO - [2022-06-14 20:53:33,787] {dagbag.py:500} INFO - Filling up the DagBag from /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 20:53:53,201] {logging_mixin.py:109} INFO - [2022-06-14 20:53:53,188] {dagbag.py:334} ERROR - Failed to import: /home/leizo/airflow/dags/lib/produce_usage.py
Traceback (most recent call last):
  File "/home/leizo/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 848, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/home/leizo/airflow/dags/lib/produce_usage.py", line 68, in <module>
    df_joined_by_tag(list_spotify_playlists, list_lastfm_tracks[0])
  File "/home/leizo/airflow/dags/lib/produce_usage.py", line 64, in df_joined_by_tag
    DF_tag_playlists.write.parquet(TARGET_PATH)
  File "/home/leizo/.local/lib/python3.8/site-packages/pyspark/sql/readwriter.py", line 885, in parquet
    self._jwrite.parquet(path)
  File "/home/leizo/.local/lib/python3.8/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/home/leizo/.local/lib/python3.8/site-packages/pyspark/sql/utils.py", line 117, in deco
    raise converted from None
pyspark.sql.utils.AnalysisException: Found duplicate column(s) when inserting into file:/home/leizo/datalake/usage/recommendation/bytracks/rock/usage.parquet: `artist`, `name`
[2022-06-14 20:53:53,215] {processor.py:654} WARNING - No viable dags retrieved from /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 20:53:53,256] {processor.py:171} INFO - Processing /home/leizo/airflow/dags/lib/produce_usage.py took 19.475 seconds
[2022-06-14 20:54:29,317] {processor.py:163} INFO - Started process (PID=3943) to work on /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 20:54:29,320] {processor.py:642} INFO - Processing file /home/leizo/airflow/dags/lib/produce_usage.py for tasks to queue
[2022-06-14 20:54:29,321] {logging_mixin.py:109} INFO - [2022-06-14 20:54:29,321] {dagbag.py:500} INFO - Filling up the DagBag from /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 20:54:41,749] {logging_mixin.py:109} INFO - [2022-06-14 20:54:41,741] {dagbag.py:334} ERROR - Failed to import: /home/leizo/airflow/dags/lib/produce_usage.py
Traceback (most recent call last):
  File "/home/leizo/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 848, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/home/leizo/airflow/dags/lib/produce_usage.py", line 68, in <module>
    df_joined_by_tag(list_spotify_playlists, list_lastfm_tracks[0])
  File "/home/leizo/airflow/dags/lib/produce_usage.py", line 64, in df_joined_by_tag
    DF_tag_playlists.write.parquet(TARGET_PATH)
  File "/home/leizo/.local/lib/python3.8/site-packages/pyspark/sql/readwriter.py", line 885, in parquet
    self._jwrite.parquet(path)
  File "/home/leizo/.local/lib/python3.8/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/home/leizo/.local/lib/python3.8/site-packages/pyspark/sql/utils.py", line 117, in deco
    raise converted from None
pyspark.sql.utils.AnalysisException: Found duplicate column(s) when inserting into file:/home/leizo/datalake/usage/recommendation/bytracks/rock/usage.parquet: `artist`, `name`
[2022-06-14 20:54:41,755] {processor.py:654} WARNING - No viable dags retrieved from /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 20:54:41,769] {processor.py:171} INFO - Processing /home/leizo/airflow/dags/lib/produce_usage.py took 12.455 seconds
[2022-06-14 20:55:22,171] {processor.py:163} INFO - Started process (PID=4614) to work on /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 20:55:22,172] {processor.py:642} INFO - Processing file /home/leizo/airflow/dags/lib/produce_usage.py for tasks to queue
[2022-06-14 20:55:22,173] {logging_mixin.py:109} INFO - [2022-06-14 20:55:22,173] {dagbag.py:500} INFO - Filling up the DagBag from /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 20:55:44,137] {logging_mixin.py:109} INFO - 36
[2022-06-14 20:55:44,140] {logging_mixin.py:109} INFO - root
 |-- artist: string (nullable = true)
 |-- duration_s: long (nullable = true)
 |-- name: string (nullable = true)
 |-- rank_tag_rock: long (nullable = true)
 |-- album_name: string (nullable = true)
 |-- album_total_tracks: long (nullable = true)
 |-- artist: string (nullable = true)
 |-- duration_ms: long (nullable = true)
 |-- name: string (nullable = true)
 |-- popularity: long (nullable = true)
 |-- release_date: date (nullable = true)
 |-- track_number: long (nullable = true)
[2022-06-14 20:55:44,140] {logging_mixin.py:109} INFO - 
[2022-06-14 20:55:44,396] {logging_mixin.py:109} INFO - [2022-06-14 20:55:44,386] {dagbag.py:334} ERROR - Failed to import: /home/leizo/airflow/dags/lib/produce_usage.py
Traceback (most recent call last):
  File "/home/leizo/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 848, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/home/leizo/airflow/dags/lib/produce_usage.py", line 71, in <module>
    df_joined_by_tag(list_spotify_playlists, list_lastfm_tracks[0])
  File "/home/leizo/airflow/dags/lib/produce_usage.py", line 67, in df_joined_by_tag
    DF_tag_playlists.write.parquet(TARGET_PATH)
  File "/home/leizo/.local/lib/python3.8/site-packages/pyspark/sql/readwriter.py", line 885, in parquet
    self._jwrite.parquet(path)
  File "/home/leizo/.local/lib/python3.8/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/home/leizo/.local/lib/python3.8/site-packages/pyspark/sql/utils.py", line 117, in deco
    raise converted from None
pyspark.sql.utils.AnalysisException: Found duplicate column(s) when inserting into file:/home/leizo/datalake/usage/recommendation/bytracks/rock/usage.parquet: `artist`, `name`
[2022-06-14 20:55:44,405] {processor.py:654} WARNING - No viable dags retrieved from /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 20:55:44,429] {processor.py:171} INFO - Processing /home/leizo/airflow/dags/lib/produce_usage.py took 22.262 seconds
[2022-06-14 20:56:21,491] {processor.py:163} INFO - Started process (PID=5707) to work on /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 20:56:21,495] {processor.py:642} INFO - Processing file /home/leizo/airflow/dags/lib/produce_usage.py for tasks to queue
[2022-06-14 20:56:21,496] {logging_mixin.py:109} INFO - [2022-06-14 20:56:21,496] {dagbag.py:500} INFO - Filling up the DagBag from /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 20:56:42,102] {logging_mixin.py:109} INFO - 36
[2022-06-14 20:56:42,106] {logging_mixin.py:109} INFO - root
 |-- artist: string (nullable = true)
 |-- duration_s: long (nullable = true)
 |-- name: string (nullable = true)
 |-- rank_tag_rock: long (nullable = true)
 |-- album_name: string (nullable = true)
 |-- album_total_tracks: long (nullable = true)
 |-- artist: string (nullable = true)
 |-- duration_ms: long (nullable = true)
 |-- name: string (nullable = true)
 |-- popularity: long (nullable = true)
 |-- release_date: date (nullable = true)
 |-- track_number: long (nullable = true)
[2022-06-14 20:56:42,106] {logging_mixin.py:109} INFO - 
[2022-06-14 20:56:42,364] {logging_mixin.py:109} INFO - [2022-06-14 20:56:42,350] {dagbag.py:334} ERROR - Failed to import: /home/leizo/airflow/dags/lib/produce_usage.py
Traceback (most recent call last):
  File "/home/leizo/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 848, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/home/leizo/airflow/dags/lib/produce_usage.py", line 71, in <module>
    df_joined_by_tag(list_spotify_playlists, list_lastfm_tracks[0])
  File "/home/leizo/airflow/dags/lib/produce_usage.py", line 67, in df_joined_by_tag
    DF_tag_playlists.write.parquet(TARGET_PATH)
  File "/home/leizo/.local/lib/python3.8/site-packages/pyspark/sql/readwriter.py", line 885, in parquet
    self._jwrite.parquet(path)
  File "/home/leizo/.local/lib/python3.8/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/home/leizo/.local/lib/python3.8/site-packages/pyspark/sql/utils.py", line 117, in deco
    raise converted from None
pyspark.sql.utils.AnalysisException: Found duplicate column(s) when inserting into file:/home/leizo/datalake/usage/recommendation/bytracks/rock/usage.parquet: `artist`, `name`
[2022-06-14 20:56:42,372] {processor.py:654} WARNING - No viable dags retrieved from /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 20:56:42,394] {processor.py:171} INFO - Processing /home/leizo/airflow/dags/lib/produce_usage.py took 20.909 seconds
[2022-06-14 20:57:25,645] {processor.py:163} INFO - Started process (PID=6411) to work on /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 20:57:25,648] {processor.py:642} INFO - Processing file /home/leizo/airflow/dags/lib/produce_usage.py for tasks to queue
[2022-06-14 20:57:25,649] {logging_mixin.py:109} INFO - [2022-06-14 20:57:25,649] {dagbag.py:500} INFO - Filling up the DagBag from /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 20:57:45,800] {logging_mixin.py:109} INFO - 36
[2022-06-14 20:57:45,803] {logging_mixin.py:109} INFO - root
 |-- artist: string (nullable = true)
 |-- duration_s: long (nullable = true)
 |-- name: string (nullable = true)
 |-- rank_tag_rock: long (nullable = true)
 |-- album_name: string (nullable = true)
 |-- album_total_tracks: long (nullable = true)
 |-- artist: string (nullable = true)
 |-- duration_ms: long (nullable = true)
 |-- name: string (nullable = true)
 |-- popularity: long (nullable = true)
 |-- release_date: date (nullable = true)
 |-- track_number: long (nullable = true)
[2022-06-14 20:57:45,803] {logging_mixin.py:109} INFO - 
[2022-06-14 20:57:46,059] {logging_mixin.py:109} INFO - [2022-06-14 20:57:46,051] {dagbag.py:334} ERROR - Failed to import: /home/leizo/airflow/dags/lib/produce_usage.py
Traceback (most recent call last):
  File "/home/leizo/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 848, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/home/leizo/airflow/dags/lib/produce_usage.py", line 71, in <module>
    df_joined_by_tag(list_spotify_playlists, list_lastfm_tracks[0])
  File "/home/leizo/airflow/dags/lib/produce_usage.py", line 67, in df_joined_by_tag
    DF_tag_playlists.write.parquet(TARGET_PATH)
  File "/home/leizo/.local/lib/python3.8/site-packages/pyspark/sql/readwriter.py", line 885, in parquet
    self._jwrite.parquet(path)
  File "/home/leizo/.local/lib/python3.8/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/home/leizo/.local/lib/python3.8/site-packages/pyspark/sql/utils.py", line 117, in deco
    raise converted from None
pyspark.sql.utils.AnalysisException: Found duplicate column(s) when inserting into file:/home/leizo/datalake/usage/recommendation/bytracks/rock/usage.parquet: `artist`, `name`
[2022-06-14 20:57:46,066] {processor.py:654} WARNING - No viable dags retrieved from /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 20:57:46,095] {processor.py:171} INFO - Processing /home/leizo/airflow/dags/lib/produce_usage.py took 20.459 seconds
[2022-06-14 20:58:23,334] {processor.py:163} INFO - Started process (PID=7186) to work on /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 20:58:23,338] {processor.py:642} INFO - Processing file /home/leizo/airflow/dags/lib/produce_usage.py for tasks to queue
[2022-06-14 20:58:23,340] {logging_mixin.py:109} INFO - [2022-06-14 20:58:23,339] {dagbag.py:500} INFO - Filling up the DagBag from /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 20:58:45,576] {logging_mixin.py:109} INFO - 36
[2022-06-14 20:58:45,579] {logging_mixin.py:109} INFO - root
 |-- artist: string (nullable = true)
 |-- duration_s: long (nullable = true)
 |-- name: string (nullable = true)
 |-- rank_tag_rock: long (nullable = true)
 |-- album_name: string (nullable = true)
 |-- album_total_tracks: long (nullable = true)
 |-- artist: string (nullable = true)
 |-- duration_ms: long (nullable = true)
 |-- name: string (nullable = true)
 |-- popularity: long (nullable = true)
 |-- release_date: date (nullable = true)
 |-- track_number: long (nullable = true)
[2022-06-14 20:58:45,580] {logging_mixin.py:109} INFO - 
[2022-06-14 20:58:45,833] {logging_mixin.py:109} INFO - [2022-06-14 20:58:45,824] {dagbag.py:334} ERROR - Failed to import: /home/leizo/airflow/dags/lib/produce_usage.py
Traceback (most recent call last):
  File "/home/leizo/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 848, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/home/leizo/airflow/dags/lib/produce_usage.py", line 71, in <module>
    df_joined_by_tag(list_spotify_playlists, list_lastfm_tracks[0])
  File "/home/leizo/airflow/dags/lib/produce_usage.py", line 67, in df_joined_by_tag
    DF_tag_playlists.write.parquet(TARGET_PATH)
  File "/home/leizo/.local/lib/python3.8/site-packages/pyspark/sql/readwriter.py", line 885, in parquet
    self._jwrite.parquet(path)
  File "/home/leizo/.local/lib/python3.8/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/home/leizo/.local/lib/python3.8/site-packages/pyspark/sql/utils.py", line 117, in deco
    raise converted from None
pyspark.sql.utils.AnalysisException: Found duplicate column(s) when inserting into file:/home/leizo/datalake/usage/recommendation/bytracks/rock/usage.parquet: `artist`, `name`
[2022-06-14 20:58:45,839] {processor.py:654} WARNING - No viable dags retrieved from /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 20:58:45,865] {processor.py:171} INFO - Processing /home/leizo/airflow/dags/lib/produce_usage.py took 22.537 seconds
[2022-06-14 20:59:28,167] {processor.py:163} INFO - Started process (PID=7824) to work on /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 20:59:28,170] {processor.py:642} INFO - Processing file /home/leizo/airflow/dags/lib/produce_usage.py for tasks to queue
[2022-06-14 20:59:28,172] {logging_mixin.py:109} INFO - [2022-06-14 20:59:28,171] {dagbag.py:500} INFO - Filling up the DagBag from /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 20:59:49,497] {logging_mixin.py:109} INFO - 36
[2022-06-14 20:59:49,501] {logging_mixin.py:109} INFO - root
 |-- artist: string (nullable = true)
 |-- duration_s: long (nullable = true)
 |-- name: string (nullable = true)
 |-- rank_tag_rock: long (nullable = true)
 |-- album_name: string (nullable = true)
 |-- album_total_tracks: long (nullable = true)
 |-- artist: string (nullable = true)
 |-- duration_ms: long (nullable = true)
 |-- name: string (nullable = true)
 |-- popularity: long (nullable = true)
 |-- release_date: date (nullable = true)
 |-- track_number: long (nullable = true)
[2022-06-14 20:59:49,501] {logging_mixin.py:109} INFO - 
[2022-06-14 20:59:49,763] {logging_mixin.py:109} INFO - [2022-06-14 20:59:49,749] {dagbag.py:334} ERROR - Failed to import: /home/leizo/airflow/dags/lib/produce_usage.py
Traceback (most recent call last):
  File "/home/leizo/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 848, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/home/leizo/airflow/dags/lib/produce_usage.py", line 71, in <module>
    df_joined_by_tag(list_spotify_playlists, list_lastfm_tracks[0])
  File "/home/leizo/airflow/dags/lib/produce_usage.py", line 67, in df_joined_by_tag
    DF_tag_playlists.write.parquet(TARGET_PATH)
  File "/home/leizo/.local/lib/python3.8/site-packages/pyspark/sql/readwriter.py", line 885, in parquet
    self._jwrite.parquet(path)
  File "/home/leizo/.local/lib/python3.8/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/home/leizo/.local/lib/python3.8/site-packages/pyspark/sql/utils.py", line 117, in deco
    raise converted from None
pyspark.sql.utils.AnalysisException: Found duplicate column(s) when inserting into file:/home/leizo/datalake/usage/recommendation/bytracks/rock/usage.parquet: `artist`, `name`
[2022-06-14 20:59:49,768] {processor.py:654} WARNING - No viable dags retrieved from /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 20:59:49,792] {processor.py:171} INFO - Processing /home/leizo/airflow/dags/lib/produce_usage.py took 21.630 seconds
[2022-06-14 21:00:29,722] {processor.py:163} INFO - Started process (PID=8598) to work on /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 21:00:29,725] {processor.py:642} INFO - Processing file /home/leizo/airflow/dags/lib/produce_usage.py for tasks to queue
[2022-06-14 21:00:29,726] {logging_mixin.py:109} INFO - [2022-06-14 21:00:29,726] {dagbag.py:500} INFO - Filling up the DagBag from /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 21:00:52,389] {logging_mixin.py:109} INFO - [2022-06-14 21:00:52,382] {dagbag.py:334} ERROR - Failed to import: /home/leizo/airflow/dags/lib/produce_usage.py
Traceback (most recent call last):
  File "/home/leizo/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 848, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/home/leizo/airflow/dags/lib/produce_usage.py", line 71, in <module>
    df_joined_by_tag(list_spotify_playlists, list_lastfm_tracks[0])
  File "/home/leizo/airflow/dags/lib/produce_usage.py", line 61, in df_joined_by_tag
    print(DF_tag_playlists.count())
  File "/home/leizo/.local/lib/python3.8/site-packages/pyspark/sql/dataframe.py", line 680, in count
    return int(self._jdf.count())
  File "/home/leizo/.local/lib/python3.8/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/home/leizo/.local/lib/python3.8/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/home/leizo/.local/lib/python3.8/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o161.count.
: org.apache.spark.SparkException: Job aborted due to stage failure: Task 2 in stage 28.0 failed 1 times, most recent failure: Lost task 2.0 in stage 28.0 (TID 30) (172.17.148.86 executor driver): java.io.FileNotFoundException: 
File file:/home/leizo/datalake/formatted/lastfm/topTracks/rock/20220614/lastfm.parquet/part-00000-607ce362-6010-4443-9559-08228faf6d85-c000.snappy.parquet does not exist

It is possible the underlying files have been updated. You can explicitly invalidate
the cache in Spark by running 'REFRESH TABLE tableName' command in SQL or by
recreating the Dataset/DataFrame involved.
       
	at org.apache.spark.sql.errors.QueryExecutionErrors$.readCurrentFileNotFoundError(QueryExecutionErrors.scala:506)
	at org.apache.spark.sql.execution.datasources.FileScanRDD$$anon$1.org$apache$spark$sql$execution$datasources$FileScanRDD$$anon$$readCurrentFile(FileScanRDD.scala:130)
	at org.apache.spark.sql.execution.datasources.FileScanRDD$$anon$1.nextIterator(FileScanRDD.scala:187)
	at org.apache.spark.sql.execution.datasources.FileScanRDD$$anon$1.hasNext(FileScanRDD.scala:104)
	at org.apache.spark.sql.execution.FileSourceScanExec$$anon$1.hasNext(DataSourceScanExec.scala:522)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage13.columnartorow_nextBatch_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage13.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenExec$$anon$1.hasNext(WholeStageCodegenExec.scala:759)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage21.agg_doAggregateWithoutKey_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage21.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenExec$$anon$1.hasNext(WholeStageCodegenExec.scala:759)
	at scala.collection.Iterator$$anon$10.hasNext(Iterator.scala:460)
	at org.apache.spark.shuffle.sort.BypassMergeSortShuffleWriter.write(BypassMergeSortShuffleWriter.java:140)
	at org.apache.spark.shuffle.ShuffleWriteProcessor.write(ShuffleWriteProcessor.scala:59)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:99)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:52)
	at org.apache.spark.scheduler.Task.run(Task.scala:131)
	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$3(Executor.scala:506)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1462)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:509)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)

Driver stacktrace:
	at org.apache.spark.scheduler.DAGScheduler.failJobAndIndependentStages(DAGScheduler.scala:2454)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2(DAGScheduler.scala:2403)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2$adapted(DAGScheduler.scala:2402)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at org.apache.spark.scheduler.DAGScheduler.abortStage(DAGScheduler.scala:2402)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1(DAGScheduler.scala:1160)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1$adapted(DAGScheduler.scala:1160)
	at scala.Option.foreach(Option.scala:407)
	at org.apache.spark.scheduler.DAGScheduler.handleTaskSetFailed(DAGScheduler.scala:1160)
	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.doOnReceive(DAGScheduler.scala:2642)
	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2584)
	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2573)
	at org.apache.spark.util.EventLoop$$anon$1.run(EventLoop.scala:49)
Caused by: java.io.FileNotFoundException: 
File file:/home/leizo/datalake/formatted/lastfm/topTracks/rock/20220614/lastfm.parquet/part-00000-607ce362-6010-4443-9559-08228faf6d85-c000.snappy.parquet does not exist

It is possible the underlying files have been updated. You can explicitly invalidate
the cache in Spark by running 'REFRESH TABLE tableName' command in SQL or by
recreating the Dataset/DataFrame involved.
       
	at org.apache.spark.sql.errors.QueryExecutionErrors$.readCurrentFileNotFoundError(QueryExecutionErrors.scala:506)
	at org.apache.spark.sql.execution.datasources.FileScanRDD$$anon$1.org$apache$spark$sql$execution$datasources$FileScanRDD$$anon$$readCurrentFile(FileScanRDD.scala:130)
	at org.apache.spark.sql.execution.datasources.FileScanRDD$$anon$1.nextIterator(FileScanRDD.scala:187)
	at org.apache.spark.sql.execution.datasources.FileScanRDD$$anon$1.hasNext(FileScanRDD.scala:104)
	at org.apache.spark.sql.execution.FileSourceScanExec$$anon$1.hasNext(DataSourceScanExec.scala:522)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage13.columnartorow_nextBatch_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage13.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenExec$$anon$1.hasNext(WholeStageCodegenExec.scala:759)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage21.agg_doAggregateWithoutKey_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage21.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenExec$$anon$1.hasNext(WholeStageCodegenExec.scala:759)
	at scala.collection.Iterator$$anon$10.hasNext(Iterator.scala:460)
	at org.apache.spark.shuffle.sort.BypassMergeSortShuffleWriter.write(BypassMergeSortShuffleWriter.java:140)
	at org.apache.spark.shuffle.ShuffleWriteProcessor.write(ShuffleWriteProcessor.scala:59)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:99)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:52)
	at org.apache.spark.scheduler.Task.run(Task.scala:131)
	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$3(Executor.scala:506)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1462)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:509)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
[2022-06-14 21:00:52,392] {processor.py:654} WARNING - No viable dags retrieved from /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 21:00:52,436] {processor.py:171} INFO - Processing /home/leizo/airflow/dags/lib/produce_usage.py took 22.719 seconds
[2022-06-14 21:01:35,301] {processor.py:163} INFO - Started process (PID=9713) to work on /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 21:01:35,303] {processor.py:642} INFO - Processing file /home/leizo/airflow/dags/lib/produce_usage.py for tasks to queue
[2022-06-14 21:01:35,304] {logging_mixin.py:109} INFO - [2022-06-14 21:01:35,304] {dagbag.py:500} INFO - Filling up the DagBag from /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 21:01:42,479] {logging_mixin.py:109} INFO - [2022-06-14 21:01:42,460] {dagbag.py:334} ERROR - Failed to import: /home/leizo/airflow/dags/lib/produce_usage.py
Traceback (most recent call last):
  File "/home/leizo/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 848, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/home/leizo/airflow/dags/lib/produce_usage.py", line 24, in <module>
    df = spark.read.parquet(HOME + "/datalake/formatted/lastfm/" + "topTracks" + "/" + e + "/" + "20220614" + "/lastfm.parquet")
  File "/home/leizo/.local/lib/python3.8/site-packages/pyspark/sql/readwriter.py", line 301, in parquet
    return self._df(self._jreader.parquet(_to_seq(self._spark._sc, paths)))
  File "/home/leizo/.local/lib/python3.8/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/home/leizo/.local/lib/python3.8/site-packages/pyspark/sql/utils.py", line 117, in deco
    raise converted from None
pyspark.sql.utils.AnalysisException: Path does not exist: file:/home/leizo/datalake/formatted/lastfm/topTracks/rock/20220614/lastfm.parquet
[2022-06-14 21:01:42,498] {processor.py:654} WARNING - No viable dags retrieved from /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 21:01:42,525] {processor.py:171} INFO - Processing /home/leizo/airflow/dags/lib/produce_usage.py took 7.228 seconds
[2022-06-14 21:02:21,323] {processor.py:163} INFO - Started process (PID=11113) to work on /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 21:02:21,328] {processor.py:642} INFO - Processing file /home/leizo/airflow/dags/lib/produce_usage.py for tasks to queue
[2022-06-14 21:02:21,329] {logging_mixin.py:109} INFO - [2022-06-14 21:02:21,328] {dagbag.py:500} INFO - Filling up the DagBag from /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 21:02:46,406] {logging_mixin.py:109} INFO - 36
[2022-06-14 21:02:46,409] {logging_mixin.py:109} INFO - root
 |-- artist_name: string (nullable = true)
 |-- duration_s: long (nullable = true)
 |-- name: string (nullable = true)
 |-- rank_tag_rock: long (nullable = true)
 |-- album_name: string (nullable = true)
 |-- album_total_tracks: long (nullable = true)
 |-- artist: string (nullable = true)
 |-- duration_ms: long (nullable = true)
 |-- name: string (nullable = true)
 |-- popularity: long (nullable = true)
 |-- release_date: date (nullable = true)
 |-- track_number: long (nullable = true)
[2022-06-14 21:02:46,410] {logging_mixin.py:109} INFO - 
[2022-06-14 21:02:46,750] {logging_mixin.py:109} INFO - [2022-06-14 21:02:46,724] {dagbag.py:334} ERROR - Failed to import: /home/leizo/airflow/dags/lib/produce_usage.py
Traceback (most recent call last):
  File "/home/leizo/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 848, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/home/leizo/airflow/dags/lib/produce_usage.py", line 71, in <module>
    df_joined_by_tag(list_spotify_playlists, list_lastfm_tracks[0])
  File "/home/leizo/airflow/dags/lib/produce_usage.py", line 67, in df_joined_by_tag
    DF_tag_playlists.write.parquet(TARGET_PATH)
  File "/home/leizo/.local/lib/python3.8/site-packages/pyspark/sql/readwriter.py", line 885, in parquet
    self._jwrite.parquet(path)
  File "/home/leizo/.local/lib/python3.8/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/home/leizo/.local/lib/python3.8/site-packages/pyspark/sql/utils.py", line 117, in deco
    raise converted from None
pyspark.sql.utils.AnalysisException: Found duplicate column(s) when inserting into file:/home/leizo/datalake/usage/recommendation/bytracks/rock/usage.parquet: `name`
[2022-06-14 21:02:46,758] {processor.py:654} WARNING - No viable dags retrieved from /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 21:02:46,887] {processor.py:171} INFO - Processing /home/leizo/airflow/dags/lib/produce_usage.py took 25.571 seconds
[2022-06-14 21:03:55,828] {processor.py:163} INFO - Started process (PID=12816) to work on /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 21:03:55,832] {processor.py:642} INFO - Processing file /home/leizo/airflow/dags/lib/produce_usage.py for tasks to queue
[2022-06-14 21:03:55,834] {logging_mixin.py:109} INFO - [2022-06-14 21:03:55,833] {dagbag.py:500} INFO - Filling up the DagBag from /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 21:04:16,983] {logging_mixin.py:109} INFO - 36
[2022-06-14 21:04:16,986] {logging_mixin.py:109} INFO - root
 |-- artist_name: string (nullable = true)
 |-- duration_s: long (nullable = true)
 |-- name: string (nullable = true)
 |-- rank_tag_rock: long (nullable = true)
 |-- album_name: string (nullable = true)
 |-- album_total_tracks: long (nullable = true)
 |-- artist: string (nullable = true)
 |-- duration_ms: long (nullable = true)
 |-- name: string (nullable = true)
 |-- popularity: long (nullable = true)
 |-- release_date: date (nullable = true)
 |-- track_number: long (nullable = true)
[2022-06-14 21:04:16,987] {logging_mixin.py:109} INFO - 
[2022-06-14 21:04:17,290] {logging_mixin.py:109} INFO - [2022-06-14 21:04:17,277] {dagbag.py:334} ERROR - Failed to import: /home/leizo/airflow/dags/lib/produce_usage.py
Traceback (most recent call last):
  File "/home/leizo/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 848, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/home/leizo/airflow/dags/lib/produce_usage.py", line 71, in <module>
    df_joined_by_tag(list_spotify_playlists, list_lastfm_tracks[0])
  File "/home/leizo/airflow/dags/lib/produce_usage.py", line 67, in df_joined_by_tag
    DF_tag_playlists.write.parquet(TARGET_PATH)
  File "/home/leizo/.local/lib/python3.8/site-packages/pyspark/sql/readwriter.py", line 885, in parquet
    self._jwrite.parquet(path)
  File "/home/leizo/.local/lib/python3.8/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/home/leizo/.local/lib/python3.8/site-packages/pyspark/sql/utils.py", line 117, in deco
    raise converted from None
pyspark.sql.utils.AnalysisException: Found duplicate column(s) when inserting into file:/home/leizo/datalake/usage/recommendation/bytracks/rock/usage.parquet: `name`
[2022-06-14 21:04:17,297] {processor.py:654} WARNING - No viable dags retrieved from /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 21:04:17,315] {processor.py:171} INFO - Processing /home/leizo/airflow/dags/lib/produce_usage.py took 21.493 seconds
[2022-06-14 21:04:39,809] {processor.py:163} INFO - Started process (PID=13402) to work on /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 21:04:39,811] {processor.py:642} INFO - Processing file /home/leizo/airflow/dags/lib/produce_usage.py for tasks to queue
[2022-06-14 21:04:39,812] {logging_mixin.py:109} INFO - [2022-06-14 21:04:39,812] {dagbag.py:500} INFO - Filling up the DagBag from /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 21:04:55,016] {logging_mixin.py:109} INFO - [2022-06-14 21:04:55,002] {dagbag.py:334} ERROR - Failed to import: /home/leizo/airflow/dags/lib/produce_usage.py
Traceback (most recent call last):
  File "/home/leizo/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 848, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/home/leizo/airflow/dags/lib/produce_usage.py", line 71, in <module>
    df_joined_by_tag(list_spotify_playlists, list_lastfm_tracks[0])
  File "/home/leizo/airflow/dags/lib/produce_usage.py", line 56, in df_joined_by_tag
    DF_tag_playlists = DF_tag_playlists.union(df_join) \
  File "/home/leizo/.local/lib/python3.8/site-packages/pyspark/sql/dataframe.py", line 1844, in union
    return DataFrame(self._jdf.union(other._jdf), self.sql_ctx)
  File "/home/leizo/.local/lib/python3.8/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/home/leizo/.local/lib/python3.8/site-packages/pyspark/sql/utils.py", line 117, in deco
    raise converted from None
pyspark.sql.utils.AnalysisException: Union can only be performed on tables with the same number of columns, but the first table has 12 columns and the second table has 11 columns;
'Union false, false
:- Join Inner, (name#2 = name#52)
:  :- Relation [artist_name#0,duration_s#1L,name#2,rank_tag_rock#3L] parquet
:  +- Relation [album_name#48,album_total_tracks#49L,artist#50,duration_ms#51L,name#52,popularity#53L,release_date#54,track_number#55L] parquet
+- Project [name#245, artist_name#243, duration_s#244L, rank_tag_rock#246L, album_name#64, album_total_tracks#65L, artist#66, duration_ms#67L, popularity#69L, release_date#70, track_number#71L]
   +- Join Inner, (name#245 = name#68)
      :- Relation [artist_name#243,duration_s#244L,name#245,rank_tag_rock#246L] parquet
      +- Relation [album_name#64,album_total_tracks#65L,artist#66,duration_ms#67L,name#68,popularity#69L,release_date#70,track_number#71L] parquet
[2022-06-14 21:04:55,028] {processor.py:654} WARNING - No viable dags retrieved from /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 21:04:55,063] {processor.py:171} INFO - Processing /home/leizo/airflow/dags/lib/produce_usage.py took 15.256 seconds
[2022-06-14 21:05:57,961] {processor.py:163} INFO - Started process (PID=14918) to work on /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 21:05:57,971] {processor.py:642} INFO - Processing file /home/leizo/airflow/dags/lib/produce_usage.py for tasks to queue
[2022-06-14 21:05:57,972] {logging_mixin.py:109} INFO - [2022-06-14 21:05:57,971] {dagbag.py:500} INFO - Filling up the DagBag from /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 21:06:16,185] {logging_mixin.py:109} INFO - root
 |-- artist_name: string (nullable = true)
 |-- duration_s: long (nullable = true)
 |-- name: string (nullable = true)
 |-- rank_tag_rock: long (nullable = true)
 |-- album_name: string (nullable = true)
 |-- album_total_tracks: long (nullable = true)
 |-- artist: string (nullable = true)
 |-- duration_ms: long (nullable = true)
 |-- name: string (nullable = true)
 |-- popularity: long (nullable = true)
 |-- release_date: date (nullable = true)
 |-- track_number: long (nullable = true)
[2022-06-14 21:06:16,186] {logging_mixin.py:109} INFO - 
[2022-06-14 21:06:16,374] {logging_mixin.py:109} INFO - [2022-06-14 21:06:16,359] {dagbag.py:334} ERROR - Failed to import: /home/leizo/airflow/dags/lib/produce_usage.py
Traceback (most recent call last):
  File "/home/leizo/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 848, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/home/leizo/airflow/dags/lib/produce_usage.py", line 73, in <module>
    df_joined_by_tag(list_spotify_playlists, list_lastfm_tracks[0])
  File "/home/leizo/airflow/dags/lib/produce_usage.py", line 58, in df_joined_by_tag
    DF_tag_playlists = DF_tag_playlists.union(df_join) \
  File "/home/leizo/.local/lib/python3.8/site-packages/pyspark/sql/dataframe.py", line 1844, in union
    return DataFrame(self._jdf.union(other._jdf), self.sql_ctx)
  File "/home/leizo/.local/lib/python3.8/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/home/leizo/.local/lib/python3.8/site-packages/pyspark/sql/utils.py", line 117, in deco
    raise converted from None
pyspark.sql.utils.AnalysisException: Union can only be performed on tables with the same number of columns, but the first table has 12 columns and the second table has 11 columns;
'Union false, false
:- Join Inner, (name#2 = name#52)
:  :- Relation [artist_name#0,duration_s#1L,name#2,rank_tag_rock#3L] parquet
:  +- Relation [album_name#48,album_total_tracks#49L,artist#50,duration_ms#51L,name#52,popularity#53L,release_date#54,track_number#55L] parquet
+- Project [name#245, artist_name#243, duration_s#244L, rank_tag_rock#246L, album_name#64, album_total_tracks#65L, artist#66, duration_ms#67L, popularity#69L, release_date#70, track_number#71L]
   +- Join Inner, (name#245 = name#68)
      :- Relation [artist_name#243,duration_s#244L,name#245,rank_tag_rock#246L] parquet
      +- Relation [album_name#64,album_total_tracks#65L,artist#66,duration_ms#67L,name#68,popularity#69L,release_date#70,track_number#71L] parquet
[2022-06-14 21:06:16,392] {processor.py:654} WARNING - No viable dags retrieved from /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 21:06:16,420] {processor.py:171} INFO - Processing /home/leizo/airflow/dags/lib/produce_usage.py took 18.463 seconds
[2022-06-14 21:06:56,395] {processor.py:163} INFO - Started process (PID=16180) to work on /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 21:06:56,396] {processor.py:642} INFO - Processing file /home/leizo/airflow/dags/lib/produce_usage.py for tasks to queue
[2022-06-14 21:06:56,397] {logging_mixin.py:109} INFO - [2022-06-14 21:06:56,397] {dagbag.py:500} INFO - Filling up the DagBag from /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 21:07:09,589] {logging_mixin.py:109} INFO - root
 |-- artist_name: string (nullable = true)
 |-- duration_s: long (nullable = true)
 |-- name: string (nullable = true)
 |-- rank_tag_rock: long (nullable = true)
 |-- album_name: string (nullable = true)
 |-- album_total_tracks: long (nullable = true)
 |-- artist: string (nullable = true)
 |-- duration_ms: long (nullable = true)
 |-- name: string (nullable = true)
 |-- popularity: long (nullable = true)
 |-- release_date: date (nullable = true)
 |-- track_number: long (nullable = true)
[2022-06-14 21:07:09,590] {logging_mixin.py:109} INFO - 
[2022-06-14 21:07:09,746] {logging_mixin.py:109} INFO - [2022-06-14 21:07:09,722] {dagbag.py:334} ERROR - Failed to import: /home/leizo/airflow/dags/lib/produce_usage.py
Traceback (most recent call last):
  File "/home/leizo/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 848, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/home/leizo/airflow/dags/lib/produce_usage.py", line 73, in <module>
    df_joined_by_tag(list_spotify_playlists, list_lastfm_tracks[0])
  File "/home/leizo/airflow/dags/lib/produce_usage.py", line 58, in df_joined_by_tag
    DF_tag_playlists = DF_tag_playlists.union(df_join) \
  File "/home/leizo/.local/lib/python3.8/site-packages/pyspark/sql/dataframe.py", line 1844, in union
    return DataFrame(self._jdf.union(other._jdf), self.sql_ctx)
  File "/home/leizo/.local/lib/python3.8/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/home/leizo/.local/lib/python3.8/site-packages/pyspark/sql/utils.py", line 117, in deco
    raise converted from None
pyspark.sql.utils.AnalysisException: Union can only be performed on tables with the same number of columns, but the first table has 12 columns and the second table has 11 columns;
'Union false, false
:- Join Inner, (name#2 = name#52)
:  :- Relation [artist_name#0,duration_s#1L,name#2,rank_tag_rock#3L] parquet
:  +- Relation [album_name#48,album_total_tracks#49L,artist#50,duration_ms#51L,name#52,popularity#53L,release_date#54,track_number#55L] parquet
+- Project [name#245, artist_name#243, duration_s#244L, rank_tag_rock#246L, album_name#64, album_total_tracks#65L, artist#66, duration_ms#67L, popularity#69L, release_date#70, track_number#71L]
   +- Join Inner, (name#245 = name#68)
      :- Relation [artist_name#243,duration_s#244L,name#245,rank_tag_rock#246L] parquet
      +- Relation [album_name#64,album_total_tracks#65L,artist#66,duration_ms#67L,name#68,popularity#69L,release_date#70,track_number#71L] parquet
[2022-06-14 21:07:09,760] {processor.py:654} WARNING - No viable dags retrieved from /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 21:07:09,796] {processor.py:171} INFO - Processing /home/leizo/airflow/dags/lib/produce_usage.py took 13.404 seconds
[2022-06-14 21:08:23,590] {processor.py:163} INFO - Started process (PID=18109) to work on /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 21:08:23,592] {processor.py:642} INFO - Processing file /home/leizo/airflow/dags/lib/produce_usage.py for tasks to queue
[2022-06-14 21:08:23,593] {logging_mixin.py:109} INFO - [2022-06-14 21:08:23,593] {dagbag.py:500} INFO - Filling up the DagBag from /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 21:08:42,476] {logging_mixin.py:109} INFO - root
 |-- name: string (nullable = true)
 |-- artist_name: string (nullable = true)
 |-- duration_s: long (nullable = true)
 |-- rank_tag_rock: long (nullable = true)
 |-- album_name: string (nullable = true)
 |-- album_total_tracks: long (nullable = true)
 |-- artist: string (nullable = true)
 |-- duration_ms: long (nullable = true)
 |-- popularity: long (nullable = true)
 |-- release_date: date (nullable = true)
 |-- track_number: long (nullable = true)
[2022-06-14 21:08:42,477] {logging_mixin.py:109} INFO - 
[2022-06-14 21:08:51,196] {logging_mixin.py:109} INFO - 36
[2022-06-14 21:08:51,202] {logging_mixin.py:109} INFO - root
 |-- name: string (nullable = true)
 |-- artist_name: string (nullable = true)
 |-- duration_s: long (nullable = true)
 |-- rank_tag_rock: long (nullable = true)
 |-- album_name: string (nullable = true)
 |-- album_total_tracks: long (nullable = true)
 |-- artist: string (nullable = true)
 |-- duration_ms: long (nullable = true)
 |-- popularity: long (nullable = true)
 |-- release_date: date (nullable = true)
 |-- track_number: long (nullable = true)
[2022-06-14 21:08:51,203] {logging_mixin.py:109} INFO - 
[2022-06-14 21:08:51,735] {logging_mixin.py:109} INFO - [2022-06-14 21:08:51,718] {dagbag.py:334} ERROR - Failed to import: /home/leizo/airflow/dags/lib/produce_usage.py
Traceback (most recent call last):
  File "/home/leizo/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 848, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/home/leizo/airflow/dags/lib/produce_usage.py", line 74, in <module>
    df_joined_by_tag(list_spotify_playlists, list_lastfm_tracks[0])
  File "/home/leizo/airflow/dags/lib/produce_usage.py", line 70, in df_joined_by_tag
    DF_tag_playlists.write.parquet(TARGET_PATH)
  File "/home/leizo/.local/lib/python3.8/site-packages/pyspark/sql/readwriter.py", line 885, in parquet
    self._jwrite.parquet(path)
  File "/home/leizo/.local/lib/python3.8/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/home/leizo/.local/lib/python3.8/site-packages/pyspark/sql/utils.py", line 117, in deco
    raise converted from None
pyspark.sql.utils.AnalysisException: path file:/home/leizo/datalake/usage/recommendation/bytracks/rock/usage.parquet already exists.
[2022-06-14 21:08:51,746] {processor.py:654} WARNING - No viable dags retrieved from /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 21:08:51,779] {processor.py:171} INFO - Processing /home/leizo/airflow/dags/lib/produce_usage.py took 28.192 seconds
[2022-06-14 21:09:40,705] {processor.py:163} INFO - Started process (PID=20080) to work on /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 21:09:40,707] {processor.py:642} INFO - Processing file /home/leizo/airflow/dags/lib/produce_usage.py for tasks to queue
[2022-06-14 21:09:40,708] {logging_mixin.py:109} INFO - [2022-06-14 21:09:40,708] {dagbag.py:500} INFO - Filling up the DagBag from /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 21:09:56,256] {logging_mixin.py:109} INFO - [2022-06-14 21:09:56,244] {dagbag.py:334} ERROR - Failed to import: /home/leizo/airflow/dags/lib/produce_usage.py
Traceback (most recent call last):
  File "/home/leizo/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 848, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/home/leizo/airflow/dags/lib/produce_usage.py", line 70, in <module>
    df_joined_by_tag(list_spotify_playlists, list_lastfm_tracks[0])
  File "/home/leizo/airflow/dags/lib/produce_usage.py", line 66, in df_joined_by_tag
    DF_tag_playlists.write.parquet(TARGET_PATH)
  File "/home/leizo/.local/lib/python3.8/site-packages/pyspark/sql/readwriter.py", line 885, in parquet
    self._jwrite.parquet(path)
  File "/home/leizo/.local/lib/python3.8/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/home/leizo/.local/lib/python3.8/site-packages/pyspark/sql/utils.py", line 117, in deco
    raise converted from None
pyspark.sql.utils.AnalysisException: path file:/home/leizo/datalake/usage/recommendation/bytracks/rock/usage.parquet already exists.
[2022-06-14 21:09:56,266] {processor.py:654} WARNING - No viable dags retrieved from /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 21:09:56,286] {processor.py:171} INFO - Processing /home/leizo/airflow/dags/lib/produce_usage.py took 15.583 seconds
[2022-06-14 21:11:00,537] {processor.py:163} INFO - Started process (PID=21237) to work on /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 21:11:00,539] {processor.py:642} INFO - Processing file /home/leizo/airflow/dags/lib/produce_usage.py for tasks to queue
[2022-06-14 21:11:00,540] {logging_mixin.py:109} INFO - [2022-06-14 21:11:00,540] {dagbag.py:500} INFO - Filling up the DagBag from /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 21:11:24,517] {logging_mixin.py:109} INFO - Writing here:  /home/leizo/datalake/usage/recommendation/bytracks/rock/usage.parquet
[2022-06-14 21:11:24,518] {processor.py:654} WARNING - No viable dags retrieved from /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 21:11:24,543] {processor.py:171} INFO - Processing /home/leizo/airflow/dags/lib/produce_usage.py took 24.008 seconds
[2022-06-14 21:12:10,579] {processor.py:163} INFO - Started process (PID=22845) to work on /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 21:12:10,582] {processor.py:642} INFO - Processing file /home/leizo/airflow/dags/lib/produce_usage.py for tasks to queue
[2022-06-14 21:12:10,583] {logging_mixin.py:109} INFO - [2022-06-14 21:12:10,583] {dagbag.py:500} INFO - Filling up the DagBag from /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 21:12:32,966] {logging_mixin.py:109} INFO - paquet already exists rock 20220614
[2022-06-14 21:12:32,967] {processor.py:654} WARNING - No viable dags retrieved from /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 21:12:32,980] {processor.py:171} INFO - Processing /home/leizo/airflow/dags/lib/produce_usage.py took 22.408 seconds
[2022-06-14 21:13:36,296] {processor.py:163} INFO - Started process (PID=24370) to work on /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 21:13:36,298] {processor.py:642} INFO - Processing file /home/leizo/airflow/dags/lib/produce_usage.py for tasks to queue
[2022-06-14 21:13:36,299] {logging_mixin.py:109} INFO - [2022-06-14 21:13:36,299] {dagbag.py:500} INFO - Filling up the DagBag from /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 21:13:50,728] {logging_mixin.py:109} INFO - paquet already exists rock 20220614
[2022-06-14 21:13:50,729] {processor.py:654} WARNING - No viable dags retrieved from /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 21:13:50,746] {processor.py:171} INFO - Processing /home/leizo/airflow/dags/lib/produce_usage.py took 14.452 seconds
[2022-06-14 21:14:32,592] {processor.py:163} INFO - Started process (PID=25259) to work on /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 21:14:32,594] {processor.py:642} INFO - Processing file /home/leizo/airflow/dags/lib/produce_usage.py for tasks to queue
[2022-06-14 21:14:32,594] {logging_mixin.py:109} INFO - [2022-06-14 21:14:32,594] {dagbag.py:500} INFO - Filling up the DagBag from /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 21:14:52,944] {logging_mixin.py:109} INFO - paquet already exists rock 20220614
[2022-06-14 21:14:52,945] {processor.py:654} WARNING - No viable dags retrieved from /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 21:14:52,960] {processor.py:171} INFO - Processing /home/leizo/airflow/dags/lib/produce_usage.py took 20.371 seconds
[2022-06-14 21:15:59,256] {processor.py:163} INFO - Started process (PID=26429) to work on /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 21:15:59,258] {processor.py:642} INFO - Processing file /home/leizo/airflow/dags/lib/produce_usage.py for tasks to queue
[2022-06-14 21:15:59,259] {logging_mixin.py:109} INFO - [2022-06-14 21:15:59,259] {dagbag.py:500} INFO - Filling up the DagBag from /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 21:16:14,965] {logging_mixin.py:109} INFO - [2022-06-14 21:16:14,963] {dagbag.py:334} ERROR - Failed to import: /home/leizo/airflow/dags/lib/produce_usage.py
Traceback (most recent call last):
  File "/home/leizo/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 848, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/home/leizo/airflow/dags/lib/produce_usage.py", line 73, in <module>
    df_joined_bytracks_fromtag(list_spotify_playlists, list_lastfm_tracks[0])
TypeError: df_joined_by_tag() missing 1 required positional argument: 'top'
[2022-06-14 21:16:14,966] {processor.py:654} WARNING - No viable dags retrieved from /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 21:16:14,990] {processor.py:171} INFO - Processing /home/leizo/airflow/dags/lib/produce_usage.py took 15.737 seconds
[2022-06-14 21:17:07,056] {processor.py:163} INFO - Started process (PID=27723) to work on /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 21:17:07,058] {processor.py:642} INFO - Processing file /home/leizo/airflow/dags/lib/produce_usage.py for tasks to queue
[2022-06-14 21:17:07,058] {logging_mixin.py:109} INFO - [2022-06-14 21:17:07,058] {dagbag.py:500} INFO - Filling up the DagBag from /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 21:17:22,950] {logging_mixin.py:109} INFO - paquet already exists rock 20220614
[2022-06-14 21:17:22,951] {processor.py:654} WARNING - No viable dags retrieved from /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 21:17:22,972] {processor.py:171} INFO - Processing /home/leizo/airflow/dags/lib/produce_usage.py took 15.920 seconds
[2022-06-14 21:18:28,472] {processor.py:163} INFO - Started process (PID=28867) to work on /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 21:18:28,474] {processor.py:642} INFO - Processing file /home/leizo/airflow/dags/lib/produce_usage.py for tasks to queue
[2022-06-14 21:18:28,475] {logging_mixin.py:109} INFO - [2022-06-14 21:18:28,475] {dagbag.py:500} INFO - Filling up the DagBag from /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 21:18:43,368] {logging_mixin.py:109} INFO - paquet already exists rock 20220614
[2022-06-14 21:18:43,369] {processor.py:654} WARNING - No viable dags retrieved from /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 21:18:43,382] {processor.py:171} INFO - Processing /home/leizo/airflow/dags/lib/produce_usage.py took 14.913 seconds
[2022-06-14 21:19:26,091] {processor.py:163} INFO - Started process (PID=29757) to work on /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 21:19:26,094] {processor.py:642} INFO - Processing file /home/leizo/airflow/dags/lib/produce_usage.py for tasks to queue
[2022-06-14 21:19:26,094] {logging_mixin.py:109} INFO - [2022-06-14 21:19:26,094] {dagbag.py:500} INFO - Filling up the DagBag from /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 21:19:41,157] {logging_mixin.py:109} INFO - paquet already exists rock 20220614
[2022-06-14 21:19:41,158] {processor.py:654} WARNING - No viable dags retrieved from /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 21:19:41,169] {processor.py:171} INFO - Processing /home/leizo/airflow/dags/lib/produce_usage.py took 15.080 seconds
[2022-06-14 21:20:45,492] {processor.py:163} INFO - Started process (PID=30872) to work on /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 21:20:45,496] {processor.py:642} INFO - Processing file /home/leizo/airflow/dags/lib/produce_usage.py for tasks to queue
[2022-06-14 21:20:45,497] {logging_mixin.py:109} INFO - [2022-06-14 21:20:45,496] {dagbag.py:500} INFO - Filling up the DagBag from /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 21:21:01,419] {logging_mixin.py:109} INFO - paquet already exists rock 20220614
[2022-06-14 21:21:01,420] {processor.py:654} WARNING - No viable dags retrieved from /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 21:21:01,435] {processor.py:171} INFO - Processing /home/leizo/airflow/dags/lib/produce_usage.py took 15.945 seconds
[2022-06-14 21:21:46,219] {processor.py:163} INFO - Started process (PID=31764) to work on /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 21:21:46,221] {processor.py:642} INFO - Processing file /home/leizo/airflow/dags/lib/produce_usage.py for tasks to queue
[2022-06-14 21:21:46,222] {logging_mixin.py:109} INFO - [2022-06-14 21:21:46,221] {dagbag.py:500} INFO - Filling up the DagBag from /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 21:22:03,826] {logging_mixin.py:109} INFO - paquet already exists /rock/20220614
[2022-06-14 21:22:03,827] {processor.py:654} WARNING - No viable dags retrieved from /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 21:22:03,845] {processor.py:171} INFO - Processing /home/leizo/airflow/dags/lib/produce_usage.py took 17.628 seconds
[2022-06-14 21:23:18,414] {processor.py:163} INFO - Started process (PID=846) to work on /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 21:23:18,416] {processor.py:642} INFO - Processing file /home/leizo/airflow/dags/lib/produce_usage.py for tasks to queue
[2022-06-14 21:23:18,418] {logging_mixin.py:109} INFO - [2022-06-14 21:23:18,417] {dagbag.py:500} INFO - Filling up the DagBag from /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 21:23:35,143] {logging_mixin.py:109} INFO - [2022-06-14 21:23:35,141] {dagbag.py:334} ERROR - Failed to import: /home/leizo/airflow/dags/lib/produce_usage.py
Traceback (most recent call last):
  File "/home/leizo/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 848, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/home/leizo/airflow/dags/lib/produce_usage.py", line 73, in <module>
    produce_usage()
  File "/home/leizo/airflow/dags/lib/produce_usage.py", line 46, in produce_usage
    for i in range(list_lastfm_tracks) :
TypeError: 'list' object cannot be interpreted as an integer
[2022-06-14 21:23:35,144] {processor.py:654} WARNING - No viable dags retrieved from /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 21:23:35,176] {processor.py:171} INFO - Processing /home/leizo/airflow/dags/lib/produce_usage.py took 16.765 seconds
[2022-06-14 21:24:20,887] {processor.py:163} INFO - Started process (PID=1736) to work on /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 21:24:20,890] {processor.py:642} INFO - Processing file /home/leizo/airflow/dags/lib/produce_usage.py for tasks to queue
[2022-06-14 21:24:20,890] {logging_mixin.py:109} INFO - [2022-06-14 21:24:20,890] {dagbag.py:500} INFO - Filling up the DagBag from /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 21:24:37,533] {logging_mixin.py:109} INFO - [2022-06-14 21:24:37,531] {dagbag.py:334} ERROR - Failed to import: /home/leizo/airflow/dags/lib/produce_usage.py
Traceback (most recent call last):
  File "/home/leizo/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 848, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/home/leizo/airflow/dags/lib/produce_usage.py", line 73, in <module>
    produce_usage()
  File "/home/leizo/airflow/dags/lib/produce_usage.py", line 46, in produce_usage
    for i in range(list_lastfm_tracks) :
TypeError: 'list' object cannot be interpreted as an integer
[2022-06-14 21:24:37,534] {processor.py:654} WARNING - No viable dags retrieved from /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 21:24:37,556] {processor.py:171} INFO - Processing /home/leizo/airflow/dags/lib/produce_usage.py took 16.672 seconds
[2022-06-14 21:25:50,910] {processor.py:163} INFO - Started process (PID=3243) to work on /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 21:25:50,912] {processor.py:642} INFO - Processing file /home/leizo/airflow/dags/lib/produce_usage.py for tasks to queue
[2022-06-14 21:25:50,912] {logging_mixin.py:109} INFO - [2022-06-14 21:25:50,912] {dagbag.py:500} INFO - Filling up the DagBag from /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 21:26:05,854] {logging_mixin.py:109} INFO - [2022-06-14 21:26:05,852] {dagbag.py:334} ERROR - Failed to import: /home/leizo/airflow/dags/lib/produce_usage.py
Traceback (most recent call last):
  File "/home/leizo/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 848, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/home/leizo/airflow/dags/lib/produce_usage.py", line 73, in <module>
    produce_usage()
  File "/home/leizo/airflow/dags/lib/produce_usage.py", line 46, in produce_usage
    for i in range(list_lastfm_tracks) :
TypeError: 'list' object cannot be interpreted as an integer
[2022-06-14 21:26:05,855] {processor.py:654} WARNING - No viable dags retrieved from /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 21:26:05,883] {processor.py:171} INFO - Processing /home/leizo/airflow/dags/lib/produce_usage.py took 14.976 seconds
[2022-06-14 21:26:59,900] {processor.py:163} INFO - Started process (PID=4884) to work on /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 21:26:59,904] {processor.py:642} INFO - Processing file /home/leizo/airflow/dags/lib/produce_usage.py for tasks to queue
[2022-06-14 21:26:59,906] {logging_mixin.py:109} INFO - [2022-06-14 21:26:59,905] {dagbag.py:500} INFO - Filling up the DagBag from /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 21:27:18,003] {logging_mixin.py:109} INFO - paquet already exists /rock/20220614
[2022-06-14 21:27:18,712] {logging_mixin.py:109} INFO - paquet already exists /indie/20220614
[2022-06-14 21:27:19,219] {logging_mixin.py:109} INFO - paquet already exists /alternative/20220614
[2022-06-14 21:27:19,672] {logging_mixin.py:109} INFO - paquet already exists /pop/20220614
[2022-06-14 21:27:19,673] {processor.py:654} WARNING - No viable dags retrieved from /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 21:27:19,697] {processor.py:171} INFO - Processing /home/leizo/airflow/dags/lib/produce_usage.py took 19.802 seconds
[2022-06-14 21:28:31,116] {processor.py:163} INFO - Started process (PID=6030) to work on /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 21:28:31,118] {processor.py:642} INFO - Processing file /home/leizo/airflow/dags/lib/produce_usage.py for tasks to queue
[2022-06-14 21:28:31,119] {logging_mixin.py:109} INFO - [2022-06-14 21:28:31,119] {dagbag.py:500} INFO - Filling up the DagBag from /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 21:28:50,199] {logging_mixin.py:109} INFO - paquet already exists /rock/20220614
[2022-06-14 21:28:50,917] {logging_mixin.py:109} INFO - paquet already exists /indie/20220614
[2022-06-14 21:28:51,422] {logging_mixin.py:109} INFO - paquet already exists /alternative/20220614
[2022-06-14 21:28:51,918] {logging_mixin.py:109} INFO - paquet already exists /pop/20220614
[2022-06-14 21:28:51,919] {processor.py:654} WARNING - No viable dags retrieved from /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 21:28:51,936] {processor.py:171} INFO - Processing /home/leizo/airflow/dags/lib/produce_usage.py took 20.823 seconds
[2022-06-14 21:29:42,162] {processor.py:163} INFO - Started process (PID=7367) to work on /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 21:29:42,166] {processor.py:642} INFO - Processing file /home/leizo/airflow/dags/lib/produce_usage.py for tasks to queue
[2022-06-14 21:29:42,168] {logging_mixin.py:109} INFO - [2022-06-14 21:29:42,167] {dagbag.py:500} INFO - Filling up the DagBag from /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 21:30:03,945] {logging_mixin.py:109} INFO - paquet already exists /rock/20220614
[2022-06-14 21:30:04,686] {logging_mixin.py:109} INFO - paquet already exists /indie/20220614
[2022-06-14 21:30:05,279] {logging_mixin.py:109} INFO - paquet already exists /alternative/20220614
[2022-06-14 21:30:05,703] {logging_mixin.py:109} INFO - paquet already exists /pop/20220614
[2022-06-14 21:30:05,704] {processor.py:654} WARNING - No viable dags retrieved from /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 21:30:05,733] {processor.py:171} INFO - Processing /home/leizo/airflow/dags/lib/produce_usage.py took 23.577 seconds
[2022-06-14 21:31:17,834] {processor.py:163} INFO - Started process (PID=8567) to work on /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 21:31:17,837] {processor.py:642} INFO - Processing file /home/leizo/airflow/dags/lib/produce_usage.py for tasks to queue
[2022-06-14 21:31:17,839] {logging_mixin.py:109} INFO - [2022-06-14 21:31:17,839] {dagbag.py:500} INFO - Filling up the DagBag from /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 21:31:17,842] {logging_mixin.py:109} INFO - [2022-06-14 21:31:17,841] {dagbag.py:334} ERROR - Failed to import: /home/leizo/airflow/dags/lib/produce_usage.py
Traceback (most recent call last):
  File "/home/leizo/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 844, in exec_module
  File "<frozen importlib._bootstrap_external>", line 981, in get_code
  File "<frozen importlib._bootstrap_external>", line 911, in source_to_code
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/home/leizo/airflow/dags/lib/produce_usage.py", line 48
    df_joined_byartist_fromtag(list_lastfm_artists{i}, tags_to_parse[i])
                                                  ^
SyntaxError: invalid syntax
[2022-06-14 21:31:17,842] {processor.py:654} WARNING - No viable dags retrieved from /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 21:31:17,865] {processor.py:171} INFO - Processing /home/leizo/airflow/dags/lib/produce_usage.py took 0.034 seconds
[2022-06-14 21:32:12,303] {processor.py:163} INFO - Started process (PID=9756) to work on /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 21:32:12,307] {processor.py:642} INFO - Processing file /home/leizo/airflow/dags/lib/produce_usage.py for tasks to queue
[2022-06-14 21:32:12,308] {logging_mixin.py:109} INFO - [2022-06-14 21:32:12,308] {dagbag.py:500} INFO - Filling up the DagBag from /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 21:32:36,479] {logging_mixin.py:109} INFO - paquet already exists /rock/20220614
[2022-06-14 21:32:37,223] {logging_mixin.py:109} INFO - paquet already exists /rock/20220614
[2022-06-14 21:32:37,794] {logging_mixin.py:109} INFO - paquet already exists /indie/20220614
[2022-06-14 21:32:38,233] {logging_mixin.py:109} INFO - paquet already exists /indie/20220614
[2022-06-14 21:32:38,641] {logging_mixin.py:109} INFO - paquet already exists /alternative/20220614
[2022-06-14 21:32:38,920] {logging_mixin.py:109} INFO - paquet already exists /alternative/20220614
[2022-06-14 21:32:39,148] {logging_mixin.py:109} INFO - paquet already exists /pop/20220614
[2022-06-14 21:32:39,321] {logging_mixin.py:109} INFO - paquet already exists /pop/20220614
[2022-06-14 21:32:39,322] {processor.py:654} WARNING - No viable dags retrieved from /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 21:32:39,345] {processor.py:171} INFO - Processing /home/leizo/airflow/dags/lib/produce_usage.py took 27.048 seconds
[2022-06-14 21:33:54,870] {processor.py:163} INFO - Started process (PID=11075) to work on /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 21:33:54,871] {processor.py:642} INFO - Processing file /home/leizo/airflow/dags/lib/produce_usage.py for tasks to queue
[2022-06-14 21:33:54,872] {logging_mixin.py:109} INFO - [2022-06-14 21:33:54,872] {dagbag.py:500} INFO - Filling up the DagBag from /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 21:34:13,047] {logging_mixin.py:109} INFO - paquet already exists /bytracks/rock/20220614
[2022-06-14 21:34:13,655] {logging_mixin.py:109} INFO - paquet already exists /byartist/rock/20220614
[2022-06-14 21:34:14,192] {logging_mixin.py:109} INFO - paquet already exists /bytracks/indie/20220614
[2022-06-14 21:34:14,587] {logging_mixin.py:109} INFO - paquet already exists /byartist/indie/20220614
[2022-06-14 21:34:14,929] {logging_mixin.py:109} INFO - paquet already exists /bytracks/alternative/20220614
[2022-06-14 21:34:15,213] {logging_mixin.py:109} INFO - paquet already exists /byartist/alternative/20220614
[2022-06-14 21:34:15,434] {logging_mixin.py:109} INFO - paquet already exists /bytracks/pop/20220614
[2022-06-14 21:34:15,582] {logging_mixin.py:109} INFO - paquet already exists /byartist/pop/20220614
[2022-06-14 21:34:15,583] {processor.py:654} WARNING - No viable dags retrieved from /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 21:34:15,604] {processor.py:171} INFO - Processing /home/leizo/airflow/dags/lib/produce_usage.py took 20.737 seconds
[2022-06-14 21:35:04,959] {processor.py:163} INFO - Started process (PID=12322) to work on /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 21:35:04,962] {processor.py:642} INFO - Processing file /home/leizo/airflow/dags/lib/produce_usage.py for tasks to queue
[2022-06-14 21:35:04,963] {logging_mixin.py:109} INFO - [2022-06-14 21:35:04,963] {dagbag.py:500} INFO - Filling up the DagBag from /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 21:35:24,257] {logging_mixin.py:109} INFO - root
 |-- artist: string (nullable = true)
 |-- rank_artist_rock: long (nullable = true)
 |-- album_name: string (nullable = true)
 |-- album_total_tracks: long (nullable = true)
 |-- duration_ms: long (nullable = true)
 |-- name: string (nullable = true)
 |-- popularity: long (nullable = true)
 |-- release_date: date (nullable = true)
 |-- track_number: long (nullable = true)
[2022-06-14 21:35:24,257] {logging_mixin.py:109} INFO - 
[2022-06-14 21:35:27,293] {logging_mixin.py:109} INFO - +--------------------+----------------+--------------------+------------------+-----------+--------------------+----------+------------+------------+
|              artist|rank_artist_rock|          album_name|album_total_tracks|duration_ms|                name|popularity|release_date|track_number|
+--------------------+----------------+--------------------+------------------+-----------+--------------------+----------+------------+------------+
|         Linkin Park|               2|             Meteora|                13|     185586|                Numb|        82|  2003-03-24|          13|
|         David Bowie|               4|David Bowie (aka ...|                 9|     318026|Space Oddity - 20...|        71|  1969-11-04|           1|
|                  U2|              13|The Joshua Tree (...|                49|     295515|With Or Without Y...|        79|  1987-03-03|           3|
|   Bruce Springsteen|              19|  Born In The U.S.A.|                12|     155880|         I'm On Fire|        74|  1984-06-04|           6|
|            Bon Jovi|              25|   Slippery When Wet|                10|     249293|  Livin' On A Prayer|        83|  1986-08-16|           3|
|            Bon Jovi|              25|   Slippery When Wet|                10|     222706|You Give Love A B...|        80|  1986-08-16|           2|
|            Bon Jovi|              25|            Bon Jovi|                 9|     230666|             Runaway|        71|  1984-01-01|           1|
|            Måneskin|              41|              Chosen|                 7|     161040|    Somebody Told Me|        68|  2017-12-08|           6|
|   The Goo Goo Dolls|             164|   Dizzy up the Girl|                13|     289533|                Iris|        83|  1998-09-11|          11|
|Red Hot Chili Pep...|               3|        Black Summer|                 1|     232412|        Black Summer|        73|  2022-02-04|           1|
|        Harry Styles|               7|           As It Was|                 1|     167303|           As It Was|       100|  2022-03-31|           1|
| My Chemical Romance|               8|The Foundations o...|                 1|     360760|The Foundations o...|        77|  2022-05-12|           1|
|              Weezer|              12|A Little Bit of Love|                 1|     164359|A Little Bit of Love|        60|  2022-03-16|           1|
|            Måneskin|              41|          SUPERMODEL|                 1|     148064|          SUPERMODEL|        86|  2022-05-13|           1|
|          Jack White|              62|    Fear Of The Dawn|                12|     214842|   What's the Trick?|        59|  2022-04-08|           8|
| The Backseat Lovers|             150|When We Were Friends|                 9|     243529|         Maple Syrup|        69|  2019-01-27|           7|
| The Backseat Lovers|             150|When We Were Friends|                 9|     282205|          Kilby Girl|        78|  2019-01-27|           4|
|            M.A.G.S.|             394|Say Things That M...|                14|     199059|          Choked Out|        39|  2021-08-13|           4|
|           Rebounder|             638|        Subway Songs|                 6|     156000|    Japanese Posters|        57|  2020-10-04|           2|
+--------------------+----------------+--------------------+------------------+-----------+--------------------+----------+------------+------------+
[2022-06-14 21:35:27,293] {logging_mixin.py:109} INFO - 
[2022-06-14 21:35:27,294] {processor.py:654} WARNING - No viable dags retrieved from /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 21:35:27,314] {processor.py:171} INFO - Processing /home/leizo/airflow/dags/lib/produce_usage.py took 22.359 seconds
[2022-06-14 21:36:38,324] {processor.py:163} INFO - Started process (PID=13571) to work on /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 21:36:38,327] {processor.py:642} INFO - Processing file /home/leizo/airflow/dags/lib/produce_usage.py for tasks to queue
[2022-06-14 21:36:38,328] {logging_mixin.py:109} INFO - [2022-06-14 21:36:38,328] {dagbag.py:500} INFO - Filling up the DagBag from /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 21:36:54,360] {logging_mixin.py:109} INFO - root
 |-- artist: string (nullable = true)
 |-- rank_artist_rock: long (nullable = true)
 |-- album_name: string (nullable = true)
 |-- album_total_tracks: long (nullable = true)
 |-- duration_ms: long (nullable = true)
 |-- name: string (nullable = true)
 |-- popularity: long (nullable = true)
 |-- release_date: date (nullable = true)
 |-- track_number: long (nullable = true)
[2022-06-14 21:36:54,361] {logging_mixin.py:109} INFO - 
[2022-06-14 21:36:57,089] {logging_mixin.py:109} INFO - +--------------------+----------------+--------------------+------------------+-----------+--------------------+----------+------------+------------+
|              artist|rank_artist_rock|          album_name|album_total_tracks|duration_ms|                name|popularity|release_date|track_number|
+--------------------+----------------+--------------------+------------------+-----------+--------------------+----------+------------+------------+
|         Linkin Park|               2|             Meteora|                13|     185586|                Numb|        82|  2003-03-24|          13|
|         David Bowie|               4|David Bowie (aka ...|                 9|     318026|Space Oddity - 20...|        71|  1969-11-04|           1|
|                  U2|              13|The Joshua Tree (...|                49|     295515|With Or Without Y...|        79|  1987-03-03|           3|
|   Bruce Springsteen|              19|  Born In The U.S.A.|                12|     155880|         I'm On Fire|        74|  1984-06-04|           6|
|            Bon Jovi|              25|   Slippery When Wet|                10|     249293|  Livin' On A Prayer|        83|  1986-08-16|           3|
|            Bon Jovi|              25|   Slippery When Wet|                10|     222706|You Give Love A B...|        80|  1986-08-16|           2|
|            Bon Jovi|              25|            Bon Jovi|                 9|     230666|             Runaway|        71|  1984-01-01|           1|
|            Måneskin|              41|              Chosen|                 7|     161040|    Somebody Told Me|        68|  2017-12-08|           6|
|   The Goo Goo Dolls|             164|   Dizzy up the Girl|                13|     289533|                Iris|        83|  1998-09-11|          11|
|Red Hot Chili Pep...|               3|        Black Summer|                 1|     232412|        Black Summer|        73|  2022-02-04|           1|
|        Harry Styles|               7|           As It Was|                 1|     167303|           As It Was|       100|  2022-03-31|           1|
| My Chemical Romance|               8|The Foundations o...|                 1|     360760|The Foundations o...|        77|  2022-05-12|           1|
|              Weezer|              12|A Little Bit of Love|                 1|     164359|A Little Bit of Love|        60|  2022-03-16|           1|
|            Måneskin|              41|          SUPERMODEL|                 1|     148064|          SUPERMODEL|        86|  2022-05-13|           1|
|          Jack White|              62|    Fear Of The Dawn|                12|     214842|   What's the Trick?|        59|  2022-04-08|           8|
| The Backseat Lovers|             150|When We Were Friends|                 9|     243529|         Maple Syrup|        69|  2019-01-27|           7|
| The Backseat Lovers|             150|When We Were Friends|                 9|     282205|          Kilby Girl|        78|  2019-01-27|           4|
|            M.A.G.S.|             394|Say Things That M...|                14|     199059|          Choked Out|        39|  2021-08-13|           4|
|           Rebounder|             638|        Subway Songs|                 6|     156000|    Japanese Posters|        57|  2020-10-04|           2|
+--------------------+----------------+--------------------+------------------+-----------+--------------------+----------+------------+------------+
[2022-06-14 21:36:57,089] {logging_mixin.py:109} INFO - 
[2022-06-14 21:36:58,646] {logging_mixin.py:109} INFO - paquet already exists /bytracks/rock/20220614
[2022-06-14 21:36:59,456] {logging_mixin.py:109} INFO - paquet already exists /byartist/rock/20220614
[2022-06-14 21:37:00,074] {logging_mixin.py:109} INFO - paquet already exists /bytracks/indie/20220614
[2022-06-14 21:37:00,538] {logging_mixin.py:109} INFO - paquet already exists /byartist/indie/20220614
[2022-06-14 21:37:01,010] {logging_mixin.py:109} INFO - paquet already exists /bytracks/alternative/20220614
[2022-06-14 21:37:01,310] {logging_mixin.py:109} INFO - paquet already exists /byartist/alternative/20220614
[2022-06-14 21:37:01,570] {logging_mixin.py:109} INFO - paquet already exists /bytracks/pop/20220614
[2022-06-14 21:37:01,783] {logging_mixin.py:109} INFO - paquet already exists /byartist/pop/20220614
[2022-06-14 21:37:01,784] {processor.py:654} WARNING - No viable dags retrieved from /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 21:37:01,797] {processor.py:171} INFO - Processing /home/leizo/airflow/dags/lib/produce_usage.py took 23.475 seconds
[2022-06-14 21:37:59,295] {processor.py:163} INFO - Started process (PID=15173) to work on /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 21:37:59,299] {processor.py:642} INFO - Processing file /home/leizo/airflow/dags/lib/produce_usage.py for tasks to queue
[2022-06-14 21:37:59,300] {logging_mixin.py:109} INFO - [2022-06-14 21:37:59,300] {dagbag.py:500} INFO - Filling up the DagBag from /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 21:38:29,151] {logging_mixin.py:109} INFO - paquet already exists /bytracks/rock/20220614
[2022-06-14 21:38:29,310] {logging_mixin.py:109} INFO - [2022-06-14 21:38:29,303] {timeout.py:36} ERROR - Process timed out, PID: 15173
[2022-06-14 21:38:29,321] {logging_mixin.py:109} INFO - [2022-06-14 21:38:29,311] {clientserver.py:502} INFO - Error while receiving.
Traceback (most recent call last):
  File "/home/leizo/.local/lib/python3.8/site-packages/py4j/clientserver.py", line 475, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
  File "/usr/lib/python3.8/socket.py", line 669, in readinto
    return self._sock.recv_into(b)
  File "/home/leizo/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 37, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /home/leizo/airflow/dags/lib/produce_usage.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.2.5/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.2.5/best-practices.html#reducing-dag-complexity, PID: 15173
[2022-06-14 21:38:29,322] {logging_mixin.py:109} INFO - [2022-06-14 21:38:29,322] {clientserver.py:507} INFO - Closing down clientserver connection
[2022-06-14 21:38:29,331] {logging_mixin.py:109} INFO - [2022-06-14 21:38:29,323] {java_gateway.py:1055} ERROR - Exception while sending command.
Traceback (most recent call last):
  File "/home/leizo/.local/lib/python3.8/site-packages/py4j/clientserver.py", line 475, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
  File "/usr/lib/python3.8/socket.py", line 669, in readinto
    return self._sock.recv_into(b)
  File "/home/leizo/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 37, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /home/leizo/airflow/dags/lib/produce_usage.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.2.5/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.2.5/best-practices.html#reducing-dag-complexity, PID: 15173

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/leizo/.local/lib/python3.8/site-packages/py4j/java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
  File "/home/leizo/.local/lib/python3.8/site-packages/py4j/clientserver.py", line 503, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending or receiving
[2022-06-14 21:38:29,340] {logging_mixin.py:109} INFO - [2022-06-14 21:38:29,332] {dagbag.py:334} ERROR - Failed to import: /home/leizo/airflow/dags/lib/produce_usage.py
Traceback (most recent call last):
  File "/home/leizo/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 848, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/home/leizo/airflow/dags/lib/produce_usage.py", line 100, in <module>
    produce_usage()
  File "/home/leizo/airflow/dags/lib/produce_usage.py", line 48, in produce_usage
    df_joined_byartist_fromtag(list_lastfm_artists[i], tags_to_parse[i])
  File "/home/leizo/airflow/dags/lib/produce_usage.py", line 80, in df_joined_byartist_fromtag
    DF_tag_playlists = DF_tag_playlists.union(df_join) \
  File "/home/leizo/.local/lib/python3.8/site-packages/pyspark/sql/dataframe.py", line 1844, in union
    return DataFrame(self._jdf.union(other._jdf), self.sql_ctx)
  File "/home/leizo/.local/lib/python3.8/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/home/leizo/.local/lib/python3.8/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/home/leizo/.local/lib/python3.8/site-packages/py4j/protocol.py", line 334, in get_return_value
    raise Py4JError(
py4j.protocol.Py4JError: An error occurred while calling o156.union
[2022-06-14 21:38:29,341] {processor.py:654} WARNING - No viable dags retrieved from /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 21:38:29,414] {processor.py:171} INFO - Processing /home/leizo/airflow/dags/lib/produce_usage.py took 30.123 seconds
[2022-06-14 21:40:11,311] {processor.py:163} INFO - Started process (PID=18266) to work on /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 21:40:11,318] {processor.py:642} INFO - Processing file /home/leizo/airflow/dags/lib/produce_usage.py for tasks to queue
[2022-06-14 21:40:11,320] {logging_mixin.py:109} INFO - [2022-06-14 21:40:11,319] {dagbag.py:500} INFO - Filling up the DagBag from /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 21:40:35,775] {logging_mixin.py:109} INFO - paquet already exists /bytracks/rock/20220614
[2022-06-14 21:40:36,442] {logging_mixin.py:109} INFO - paquet already exists /byartist/rock/20220614
[2022-06-14 21:40:37,089] {logging_mixin.py:109} INFO - paquet already exists /bytracks/indie/20220614
[2022-06-14 21:40:37,542] {logging_mixin.py:109} INFO - paquet already exists /byartist/indie/20220614
[2022-06-14 21:40:37,922] {logging_mixin.py:109} INFO - paquet already exists /bytracks/alternative/20220614
[2022-06-14 21:40:38,176] {logging_mixin.py:109} INFO - paquet already exists /byartist/alternative/20220614
[2022-06-14 21:40:38,386] {logging_mixin.py:109} INFO - paquet already exists /bytracks/pop/20220614
[2022-06-14 21:40:38,533] {logging_mixin.py:109} INFO - paquet already exists /byartist/pop/20220614
[2022-06-14 21:40:38,534] {processor.py:654} WARNING - No viable dags retrieved from /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 21:40:38,557] {processor.py:171} INFO - Processing /home/leizo/airflow/dags/lib/produce_usage.py took 27.257 seconds
[2022-06-14 21:41:27,573] {processor.py:163} INFO - Started process (PID=19395) to work on /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 21:41:27,576] {processor.py:642} INFO - Processing file /home/leizo/airflow/dags/lib/produce_usage.py for tasks to queue
[2022-06-14 21:41:27,576] {logging_mixin.py:109} INFO - [2022-06-14 21:41:27,576] {dagbag.py:500} INFO - Filling up the DagBag from /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 21:41:48,528] {logging_mixin.py:109} INFO - paquet already exists /bytracks/rock/20220614
[2022-06-14 21:41:49,370] {logging_mixin.py:109} INFO - paquet already exists /byartist/rock/20220614
[2022-06-14 21:41:49,966] {logging_mixin.py:109} INFO - paquet already exists /bytracks/indie/20220614
[2022-06-14 21:41:50,383] {logging_mixin.py:109} INFO - paquet already exists /byartist/indie/20220614
[2022-06-14 21:41:50,724] {logging_mixin.py:109} INFO - paquet already exists /bytracks/alternative/20220614
[2022-06-14 21:41:51,001] {logging_mixin.py:109} INFO - paquet already exists /byartist/alternative/20220614
[2022-06-14 21:41:51,226] {logging_mixin.py:109} INFO - paquet already exists /bytracks/pop/20220614
[2022-06-14 21:41:51,389] {logging_mixin.py:109} INFO - paquet already exists /byartist/pop/20220614
[2022-06-14 21:41:51,390] {processor.py:654} WARNING - No viable dags retrieved from /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 21:41:51,410] {processor.py:171} INFO - Processing /home/leizo/airflow/dags/lib/produce_usage.py took 23.840 seconds
[2022-06-14 21:43:29,654] {processor.py:163} INFO - Started process (PID=21620) to work on /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 21:43:29,658] {processor.py:642} INFO - Processing file /home/leizo/airflow/dags/lib/produce_usage.py for tasks to queue
[2022-06-14 21:43:29,659] {logging_mixin.py:109} INFO - [2022-06-14 21:43:29,659] {dagbag.py:500} INFO - Filling up the DagBag from /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 21:43:58,750] {logging_mixin.py:109} INFO - paquet already exists /bytracks/rock/20220613
[2022-06-14 21:43:59,666] {logging_mixin.py:109} INFO - [2022-06-14 21:43:59,662] {timeout.py:36} ERROR - Process timed out, PID: 21620
[2022-06-14 21:43:59,670] {logging_mixin.py:109} INFO - [2022-06-14 21:43:59,666] {clientserver.py:502} INFO - Error while receiving.
Traceback (most recent call last):
  File "/home/leizo/.local/lib/python3.8/site-packages/py4j/clientserver.py", line 475, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
  File "/usr/lib/python3.8/socket.py", line 669, in readinto
    return self._sock.recv_into(b)
  File "/home/leizo/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 37, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /home/leizo/airflow/dags/lib/produce_usage.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.2.5/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.2.5/best-practices.html#reducing-dag-complexity, PID: 21620
[2022-06-14 21:43:59,671] {logging_mixin.py:109} INFO - [2022-06-14 21:43:59,671] {clientserver.py:507} INFO - Closing down clientserver connection
[2022-06-14 21:43:59,674] {logging_mixin.py:109} INFO - [2022-06-14 21:43:59,672] {java_gateway.py:1055} ERROR - Exception while sending command.
Traceback (most recent call last):
  File "/home/leizo/.local/lib/python3.8/site-packages/py4j/clientserver.py", line 475, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
  File "/usr/lib/python3.8/socket.py", line 669, in readinto
    return self._sock.recv_into(b)
  File "/home/leizo/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 37, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /home/leizo/airflow/dags/lib/produce_usage.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.2.5/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.2.5/best-practices.html#reducing-dag-complexity, PID: 21620

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/leizo/.local/lib/python3.8/site-packages/py4j/java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
  File "/home/leizo/.local/lib/python3.8/site-packages/py4j/clientserver.py", line 503, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending or receiving
[2022-06-14 21:43:59,674] {logging_mixin.py:109} INFO - paquet already exists /byartist/rock/20220613
[2022-06-14 21:44:11,144] {logging_mixin.py:109} INFO - Writing here:  /home/leizo/datalake/usage/recommendation/bytracks/indie/20220613/usage.parquet
[2022-06-14 21:44:15,224] {logging_mixin.py:109} INFO - Writing here:  /home/leizo/datalake/usage/recommendation/byartist/indie/20220613/usage.parquet
[2022-06-14 21:44:16,464] {logging_mixin.py:109} INFO - paquet already exists /bytracks/alternative/20220613
[2022-06-14 21:44:18,989] {logging_mixin.py:109} INFO - Writing here:  /home/leizo/datalake/usage/recommendation/byartist/alternative/20220613/usage.parquet
[2022-06-14 21:44:20,688] {logging_mixin.py:109} INFO - Writing here:  /home/leizo/datalake/usage/recommendation/bytracks/pop/20220613/usage.parquet
[2022-06-14 21:44:21,114] {logging_mixin.py:109} INFO - paquet already exists /byartist/pop/20220613
[2022-06-14 21:44:21,116] {processor.py:654} WARNING - No viable dags retrieved from /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 21:44:21,170] {processor.py:171} INFO - Processing /home/leizo/airflow/dags/lib/produce_usage.py took 51.518 seconds
[2022-06-14 21:45:15,541] {processor.py:163} INFO - Started process (PID=23783) to work on /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 21:45:15,544] {processor.py:642} INFO - Processing file /home/leizo/airflow/dags/lib/produce_usage.py for tasks to queue
[2022-06-14 21:45:15,545] {logging_mixin.py:109} INFO - [2022-06-14 21:45:15,545] {dagbag.py:500} INFO - Filling up the DagBag from /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 21:45:34,188] {logging_mixin.py:109} INFO - paquet already exists /bytracks/rock/20220614
[2022-06-14 21:45:34,967] {logging_mixin.py:109} INFO - paquet already exists /byartist/rock/20220614
[2022-06-14 21:45:35,508] {logging_mixin.py:109} INFO - paquet already exists /bytracks/indie/20220614
[2022-06-14 21:45:35,890] {logging_mixin.py:109} INFO - paquet already exists /byartist/indie/20220614
[2022-06-14 21:45:36,303] {logging_mixin.py:109} INFO - paquet already exists /bytracks/alternative/20220614
[2022-06-14 21:45:36,565] {logging_mixin.py:109} INFO - paquet already exists /byartist/alternative/20220614
[2022-06-14 21:45:36,899] {logging_mixin.py:109} INFO - paquet already exists /bytracks/pop/20220614
[2022-06-14 21:45:37,049] {logging_mixin.py:109} INFO - paquet already exists /byartist/pop/20220614
[2022-06-14 21:45:37,049] {processor.py:654} WARNING - No viable dags retrieved from /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 21:45:37,066] {processor.py:171} INFO - Processing /home/leizo/airflow/dags/lib/produce_usage.py took 21.528 seconds
[2022-06-14 21:47:00,380] {processor.py:163} INFO - Started process (PID=25564) to work on /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 21:47:00,386] {processor.py:642} INFO - Processing file /home/leizo/airflow/dags/lib/produce_usage.py for tasks to queue
[2022-06-14 21:47:00,387] {logging_mixin.py:109} INFO - [2022-06-14 21:47:00,387] {dagbag.py:500} INFO - Filling up the DagBag from /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 21:47:30,395] {logging_mixin.py:109} INFO - [2022-06-14 21:47:30,391] {timeout.py:36} ERROR - Process timed out, PID: 25564
[2022-06-14 21:47:30,421] {logging_mixin.py:109} INFO - [2022-06-14 21:47:30,397] {clientserver.py:502} INFO - Error while receiving.
Traceback (most recent call last):
  File "/home/leizo/.local/lib/python3.8/site-packages/py4j/clientserver.py", line 475, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
  File "/usr/lib/python3.8/socket.py", line 669, in readinto
    return self._sock.recv_into(b)
  File "/home/leizo/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 37, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /home/leizo/airflow/dags/lib/produce_usage.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.2.5/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.2.5/best-practices.html#reducing-dag-complexity, PID: 25564
[2022-06-14 21:47:30,425] {logging_mixin.py:109} INFO - [2022-06-14 21:47:30,425] {clientserver.py:507} INFO - Closing down clientserver connection
[2022-06-14 21:47:30,429] {logging_mixin.py:109} INFO - [2022-06-14 21:47:30,426] {java_gateway.py:1055} ERROR - Exception while sending command.
Traceback (most recent call last):
  File "/home/leizo/.local/lib/python3.8/site-packages/py4j/clientserver.py", line 475, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
  File "/usr/lib/python3.8/socket.py", line 669, in readinto
    return self._sock.recv_into(b)
  File "/home/leizo/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 37, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /home/leizo/airflow/dags/lib/produce_usage.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.2.5/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.2.5/best-practices.html#reducing-dag-complexity, PID: 25564

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/leizo/.local/lib/python3.8/site-packages/py4j/java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
  File "/home/leizo/.local/lib/python3.8/site-packages/py4j/clientserver.py", line 503, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending or receiving
[2022-06-14 21:47:30,433] {logging_mixin.py:109} INFO - [2022-06-14 21:47:30,430] {dagbag.py:334} ERROR - Failed to import: /home/leizo/airflow/dags/lib/produce_usage.py
Traceback (most recent call last):
  File "/home/leizo/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 848, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/home/leizo/airflow/dags/lib/produce_usage.py", line 42, in <module>
    df = spark.read.parquet(HOME + "/datalake/formatted/spotify/playlists/" + e + "/" + "20220614" + "/spotify.parquet")
  File "/home/leizo/.local/lib/python3.8/site-packages/pyspark/sql/readwriter.py", line 301, in parquet
    return self._df(self._jreader.parquet(_to_seq(self._spark._sc, paths)))
  File "/home/leizo/.local/lib/python3.8/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/home/leizo/.local/lib/python3.8/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/home/leizo/.local/lib/python3.8/site-packages/py4j/protocol.py", line 334, in get_return_value
    raise Py4JError(
py4j.protocol.Py4JError: An error occurred while calling o74.parquet
[2022-06-14 21:47:30,437] {processor.py:654} WARNING - No viable dags retrieved from /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 21:47:30,520] {processor.py:171} INFO - Processing /home/leizo/airflow/dags/lib/produce_usage.py took 30.149 seconds
[2022-06-14 21:48:43,539] {processor.py:163} INFO - Started process (PID=28003) to work on /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 21:48:43,542] {processor.py:642} INFO - Processing file /home/leizo/airflow/dags/lib/produce_usage.py for tasks to queue
[2022-06-14 21:48:43,542] {logging_mixin.py:109} INFO - [2022-06-14 21:48:43,542] {dagbag.py:500} INFO - Filling up the DagBag from /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 21:49:13,547] {logging_mixin.py:109} INFO - [2022-06-14 21:49:13,545] {timeout.py:36} ERROR - Process timed out, PID: 28003
[2022-06-14 21:49:13,550] {logging_mixin.py:109} INFO - [2022-06-14 21:49:13,548] {clientserver.py:502} INFO - Error while receiving.
Traceback (most recent call last):
  File "/home/leizo/.local/lib/python3.8/site-packages/py4j/clientserver.py", line 475, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
  File "/usr/lib/python3.8/socket.py", line 669, in readinto
    return self._sock.recv_into(b)
  File "/home/leizo/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 37, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /home/leizo/airflow/dags/lib/produce_usage.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.2.5/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.2.5/best-practices.html#reducing-dag-complexity, PID: 28003
[2022-06-14 21:49:13,551] {logging_mixin.py:109} INFO - [2022-06-14 21:49:13,551] {clientserver.py:507} INFO - Closing down clientserver connection
[2022-06-14 21:49:13,554] {logging_mixin.py:109} INFO - [2022-06-14 21:49:13,552] {java_gateway.py:1055} ERROR - Exception while sending command.
Traceback (most recent call last):
  File "/home/leizo/.local/lib/python3.8/site-packages/py4j/clientserver.py", line 475, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
  File "/usr/lib/python3.8/socket.py", line 669, in readinto
    return self._sock.recv_into(b)
  File "/home/leizo/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 37, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /home/leizo/airflow/dags/lib/produce_usage.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.2.5/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.2.5/best-practices.html#reducing-dag-complexity, PID: 28003

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/leizo/.local/lib/python3.8/site-packages/py4j/java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
  File "/home/leizo/.local/lib/python3.8/site-packages/py4j/clientserver.py", line 503, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending or receiving
[2022-06-14 21:49:13,556] {logging_mixin.py:109} INFO - paquet already exists /bytracks/rock/20220613
[2022-06-14 21:49:22,439] {logging_mixin.py:109} INFO - Writing here:  /home/leizo/datalake/usage/recommendation/byartist/rock/20220613/usage.parquet
[2022-06-14 21:49:26,073] {logging_mixin.py:109} INFO - Writing here:  /home/leizo/datalake/usage/recommendation/bytracks/indie/20220613/usage.parquet
[2022-06-14 21:49:28,899] {logging_mixin.py:109} INFO - Writing here:  /home/leizo/datalake/usage/recommendation/byartist/indie/20220613/usage.parquet
[2022-06-14 21:49:31,302] {logging_mixin.py:109} INFO - Writing here:  /home/leizo/datalake/usage/recommendation/bytracks/alternative/20220613/usage.parquet
[2022-06-14 21:49:33,372] {logging_mixin.py:109} INFO - Writing here:  /home/leizo/datalake/usage/recommendation/byartist/alternative/20220613/usage.parquet
[2022-06-14 21:49:35,099] {logging_mixin.py:109} INFO - Writing here:  /home/leizo/datalake/usage/recommendation/bytracks/pop/20220613/usage.parquet
[2022-06-14 21:49:36,534] {logging_mixin.py:109} INFO - Writing here:  /home/leizo/datalake/usage/recommendation/byartist/pop/20220613/usage.parquet
[2022-06-14 21:49:36,538] {processor.py:654} WARNING - No viable dags retrieved from /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 21:49:36,598] {processor.py:171} INFO - Processing /home/leizo/airflow/dags/lib/produce_usage.py took 53.062 seconds
[2022-06-14 21:51:06,971] {processor.py:163} INFO - Started process (PID=30828) to work on /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 21:51:06,977] {processor.py:642} INFO - Processing file /home/leizo/airflow/dags/lib/produce_usage.py for tasks to queue
[2022-06-14 21:51:06,979] {logging_mixin.py:109} INFO - [2022-06-14 21:51:06,978] {dagbag.py:500} INFO - Filling up the DagBag from /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 21:51:35,944] {logging_mixin.py:109} INFO - paquet already exists /bytracks/rock/20220613
[2022-06-14 21:51:36,984] {logging_mixin.py:109} INFO - [2022-06-14 21:51:36,981] {timeout.py:36} ERROR - Process timed out, PID: 30828
[2022-06-14 21:51:36,988] {logging_mixin.py:109} INFO - [2022-06-14 21:51:36,985] {clientserver.py:502} INFO - Error while receiving.
Traceback (most recent call last):
  File "/home/leizo/.local/lib/python3.8/site-packages/py4j/clientserver.py", line 475, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
  File "/usr/lib/python3.8/socket.py", line 669, in readinto
    return self._sock.recv_into(b)
  File "/home/leizo/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 37, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /home/leizo/airflow/dags/lib/produce_usage.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.2.5/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.2.5/best-practices.html#reducing-dag-complexity, PID: 30828
[2022-06-14 21:51:36,989] {logging_mixin.py:109} INFO - [2022-06-14 21:51:36,989] {clientserver.py:507} INFO - Closing down clientserver connection
[2022-06-14 21:51:36,992] {logging_mixin.py:109} INFO - [2022-06-14 21:51:36,990] {java_gateway.py:1055} ERROR - Exception while sending command.
Traceback (most recent call last):
  File "/home/leizo/.local/lib/python3.8/site-packages/py4j/clientserver.py", line 475, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
  File "/usr/lib/python3.8/socket.py", line 669, in readinto
    return self._sock.recv_into(b)
  File "/home/leizo/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 37, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /home/leizo/airflow/dags/lib/produce_usage.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.2.5/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.2.5/best-practices.html#reducing-dag-complexity, PID: 30828

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/leizo/.local/lib/python3.8/site-packages/py4j/java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
  File "/home/leizo/.local/lib/python3.8/site-packages/py4j/clientserver.py", line 503, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending or receiving
[2022-06-14 21:51:36,993] {logging_mixin.py:109} INFO - paquet already exists /byartist/rock/20220613
[2022-06-14 21:51:37,908] {logging_mixin.py:109} INFO - paquet already exists /bytracks/indie/20220613
[2022-06-14 21:51:38,502] {logging_mixin.py:109} INFO - paquet already exists /byartist/indie/20220613
[2022-06-14 21:51:39,194] {logging_mixin.py:109} INFO - paquet already exists /bytracks/alternative/20220613
[2022-06-14 21:51:39,627] {logging_mixin.py:109} INFO - paquet already exists /byartist/alternative/20220613
[2022-06-14 21:51:40,193] {logging_mixin.py:109} INFO - paquet already exists /bytracks/pop/20220613
[2022-06-14 21:51:40,555] {logging_mixin.py:109} INFO - paquet already exists /byartist/pop/20220613
[2022-06-14 21:51:40,556] {processor.py:654} WARNING - No viable dags retrieved from /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 21:51:40,579] {processor.py:171} INFO - Processing /home/leizo/airflow/dags/lib/produce_usage.py took 33.615 seconds
[2022-06-14 21:52:52,647] {processor.py:163} INFO - Started process (PID=818) to work on /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 21:52:52,649] {processor.py:642} INFO - Processing file /home/leizo/airflow/dags/lib/produce_usage.py for tasks to queue
[2022-06-14 21:52:52,650] {logging_mixin.py:109} INFO - [2022-06-14 21:52:52,650] {dagbag.py:500} INFO - Filling up the DagBag from /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 21:53:14,467] {logging_mixin.py:109} INFO - paquet already exists /bytracks/rock/20220614
[2022-06-14 21:53:15,617] {logging_mixin.py:109} INFO - paquet already exists /byartist/rock/20220614
[2022-06-14 21:53:16,408] {logging_mixin.py:109} INFO - paquet already exists /bytracks/indie/20220614
[2022-06-14 21:53:16,849] {logging_mixin.py:109} INFO - paquet already exists /byartist/indie/20220614
[2022-06-14 21:53:17,207] {logging_mixin.py:109} INFO - paquet already exists /bytracks/alternative/20220614
[2022-06-14 21:53:17,452] {logging_mixin.py:109} INFO - paquet already exists /byartist/alternative/20220614
[2022-06-14 21:53:17,656] {logging_mixin.py:109} INFO - paquet already exists /bytracks/pop/20220614
[2022-06-14 21:53:17,806] {logging_mixin.py:109} INFO - paquet already exists /byartist/pop/20220614
[2022-06-14 21:53:17,807] {processor.py:654} WARNING - No viable dags retrieved from /home/leizo/airflow/dags/lib/produce_usage.py
[2022-06-14 21:53:17,822] {processor.py:171} INFO - Processing /home/leizo/airflow/dags/lib/produce_usage.py took 25.177 seconds
